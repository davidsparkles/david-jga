(this["webpackJsonpdavid-jga-frontend"]=this["webpackJsonpdavid-jga-frontend"]||[]).push([[0],{50:function(e,t,n){},52:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var c,r=n(2),a=n.n(r),i=n(11),s=n(29),o=n.n(s),l=n(14),u=n(10),d=n(26),j=n(3),b=n(18),h=n.n(b),O=Object(j.d)({name:"permission",initialState:{token:"",permission:"none"},reducers:{changeToken:function(e,t){var n=t.payload;switch(e.token=n,h.a.get("token")!==n&&h.a.set("token",n,{sameSite:"lax",expires:30}),n){case"broiler":e.permission="edit";break;case"fittie":e.permission="view";break;default:e.permission="none"}}}}),v=O.actions.changeToken,f=function(e){return e.permission.token},p=function(e){return e.permission.permission},x=O.reducer,m=n(13),g=n(40),k=n(24),N=["id"],w=Object(k.a)({reducerPath:"rewardsApi",baseQuery:Object(m.d)({baseUrl:"/api/"}),tagTypes:["Reward"],endpoints:function(e){return{getRewards:e.query({query:function(){return"rewards"}}),getReward:e.query({query:function(e){return"rewards/".concat(e)}}),createReward:e.mutation({query:function(){return{url:"rewards",method:"POST"}},invalidatesTags:["Reward"]}),updateReward:e.mutation({query:function(e){var t=e.id,n=Object(g.a)(e,N);return{url:"rewards/".concat(t),method:"PATCH",body:n}},invalidatesTags:["Reward"]})}}}),C=w.useGetRewardsQuery,y=w.useGetRewardQuery,S=w.useCreateRewardMutation,L=w.useUpdateRewardMutation,q=Object(k.a)({reducerPath:"questApi",baseQuery:Object(m.d)({baseUrl:"/api/"}),endpoints:function(e){return{getQuest:e.query({query:function(e){return"quests/".concat(e)}})}}}),T=q.useGetQuestQuery,P=Object(j.a)({reducer:(c={permission:x},Object(d.a)(c,w.reducerPath,w.reducer),Object(d.a)(c,q.reducerPath,q.reducer),c),middleware:function(e){return e().concat(w.middleware).concat(q.middleware)}});Object(m.e)(P.dispatch);var F=n(4),E=n.n(F),A=n(5),Q=n(9);function B(e){return X.apply(this,arguments)}function X(){return(X=Object(Q.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(null!==t&&void 0!==t?t:"/api/data");case 2:if(200!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",n.json());case 5:throw console.error("Fetch error: ".concat(n.status," ").concat(n.statusText," ").concat(n.text())),new Error(n.statusText);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(50);var R=n(1);function J(e){var t,n,c,r,a,i,s,o,l,u;return Object(R.jsxs)("div",{className:"gameHeader",children:[Object(R.jsx)("div",{className:"gameHeaderTitle",children:"Quest Master"}),Object(R.jsxs)("div",{className:"gameHeaderLevel",children:["Level ",null!==(t=null===(n=e.data)||void 0===n?void 0:n.currentLevel)&&void 0!==t?t:1," / ",null!==(c=null===(r=e.data)||void 0===r?void 0:r.maxLevel)&&void 0!==c?c:"?"]}),Object(R.jsx)(M,{current:null!==(a=null===(i=e.data)||void 0===i?void 0:i.xpWithinCurrentLevel)&&void 0!==a?a:0,max:(null!==(s=null===(o=e.data)||void 0===o?void 0:o.xpToNextLevel)&&void 0!==s?s:0)+(null!==(l=null===(u=e.data)||void 0===u?void 0:u.xpWithinCurrentLevel)&&void 0!==l?l:1)})]})}function M(e){var t=100*e.current/e.max;return Object(R.jsxs)("div",{className:"gameProgressContainer",children:[Object(R.jsx)("div",{className:"gameProgressBar",children:Object(R.jsx)("div",{style:{width:"".concat(t,"%")},className:"gameProgressCurrent",children:Object(R.jsx)("div",{className:"gameProgressCurrentText",children:e.current})})}),e.max,"\u2191"]})}var U=n(21),I=n(35),D=n(36),H=function(){return Object(i.d)()},K=i.e;n(52);function W(e){var t=K(p);return Object(R.jsxs)("div",{className:"gameFooter",style:"edit"===t?{gridTemplateColumns:"auto auto auto auto"}:void 0,children:[Object(R.jsx)(l.b,{to:{pathname:"/quests",search:e.location.search},children:Object(R.jsx)(I.a,{})}),Object(R.jsx)(l.b,{to:{pathname:"/rewards",search:e.location.search},children:Object(R.jsx)(U.d,{})}),"edit"===t&&Object(R.jsx)(l.b,{to:{pathname:"/levels",search:e.location.search},children:Object(R.jsx)(D.a,{})}),Object(R.jsx)(l.b,{to:{pathname:"/settings",search:e.location.search},children:Object(R.jsx)(U.c,{})})]})}var G={post:function(e,t){return fetch(e,{credentials:"omit",headers:{"content-type":"application/json;charset=UTF-8","sec-fetch-mode":"cors"},body:JSON.stringify(t),method:"POST",mode:"cors"}).then((function(e){return e.json()})).then((function(e){return e}))},get:function(e){return fetch(e,{credentials:"omit",headers:{"content-type":"application/json;charset=UTF-8","sec-fetch-mode":"cors"},method:"GET",mode:"cors"}).then((function(e){return e.json()})).then((function(e){return e}))}},_="BDTxsv_QJLLjMkKfKrZw9kLADmciH2_E1B4Smkp9kbOLHWlrNs_3jFZA3zCyYbw9GRKq5hoEhkcHiBMf8OiGKDQ";function V(){return(V=Object(Q.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Notification.requestPermission();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(Q.a)(E.a.mark((function e(){var t,n,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=navigator)||void 0===t||null===(n=t.serviceWorker)||void 0===n?void 0:n.ready;case 2:return c=e.sent,e.next=5,c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){var e,t;return null===(e=navigator)||void 0===e||null===(t=e.serviceWorker)||void 0===t?void 0:t.ready.then((function(e){return e.pushManager.getSubscription()})).then((function(e){return e}))}var Z="serviceWorker"in navigator&&"PushManager"in window;function $(){var e=Object(r.useState)(Notification.permission),t=Object(A.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(A.a)(a,2),s=i[0],o=i[1],l=Object(r.useState)(),u=Object(A.a)(l,2),d=u[0],j=u[1],b=Object(r.useState)(null),h=Object(A.a)(b,2),O=h[0],v=h[1],f=Object(r.useState)(!0),p=Object(A.a)(f,2),x=p[0],m=p[1];return Object(r.useEffect)((function(){Z&&(m(!0),v(!1),function(){var e,t;return null===(e=navigator)||void 0===e||null===(t=e.serviceWorker)||void 0===t?void 0:t.register("/sw.js")}().then((function(){m(!1)})))}),[]),Object(r.useEffect)((function(){m(!0),v(!1),function(){var e=Object(Q.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:t=e.sent,o(t),m(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),{onClickAskUserPermission:Object(r.useCallback)((function(){return m(!0),v(!1),function(){return V.apply(this,arguments)}().then((function(e){c(e),"granted"!==e&&v({name:"Consent denied",message:"You denied the consent to receive notifications",code:0}),m(!1)}))}),[m,v,c]),onClickSusbribeToPushNotification:Object(r.useCallback)((function(){return m(!0),v(!1),function(){return z.apply(this,arguments)}().then((function(e){o(e),m(!1)})).catch((function(e){console.error("Couldn't create the notification subscription",e,"name:",e.name,"message:",e.message,"code:",e.code),v(e),m(!1)}))}),[m,v,o]),onClickSendSubscriptionToPushServer:Object(r.useCallback)((function(){null!=s&&"granted"===n?(m(!0),v(!1),G.post("/api/subscription",s).then((function(e){j(e.id),m(!1)})).catch((function(e){m(!1),v(e)}))):console.log("No userSubscription present or consent not given")}),[s,n,m,v,j]),pushServerSubscriptionId:d,onClickSendNotification:Object(r.useCallback)(function(){var e=Object(Q.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),v(!1),e.next=4,G.post("/api/custom-subscription",t).catch((function(e){m(!1),v(e)}));case 4:m(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,v]),userConsent:n,pushNotificationSupported:Z,userSubscription:s,error:O,loading:x}}function ee(){var e=Object(r.useState)(!1),t=Object(A.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(A.a)(a,2),s=i[0],o=i[1];return{loading:n,error:s,post:Object(r.useCallback)(function(){var e=Object(Q.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c(!0),e.next=4,fetch("".concat("localhost"===window.location.hostname?"http://localhost:3000":"","/api/quest"),{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o(e.t0);case 9:return e.prev=9,c(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[o,c])}}n(55);function te(e){var t=e.quests,n=e.refetch,c=K(p),a=Object(r.useState)(null==h.a.get("filterList")||"true"===h.a.get("filterList")),i=Object(A.a)(a,2),s=i[0],o=i[1],l=Object(r.useState)(null!=h.a.get("filterArchivedList")&&"true"===h.a.get("filterArchivedList")),d=Object(A.a)(l,2),j=d[0],b=d[1],O=ee(),v=O.loading,f=O.error,x=O.post,m=Object(u.g)();return Object(r.useEffect)((function(){return n()}),[n]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{className:"questList",children:[Object(R.jsxs)("div",{className:"questFilter",children:[Object(R.jsx)("input",{type:"checkbox",checked:s,onChange:function(e){o(e.target.checked),h.a.set("filterList","".concat(e.target.checked))}}),"Erledigte Quests"]}),"edit"===c&&Object(R.jsxs)("div",{className:"questFilter",children:[Object(R.jsx)("input",{type:"checkbox",checked:j,onChange:function(e){b(e.target.checked),h.a.set("filterArchivedList","".concat(e.target.checked))}}),"Archivierte Quests"]}),t.filter((function(e){var t=e.state;return!0===s||"closed"!==t})).filter((function(e){var t=e.archived;return!0===j||!1===t})).filter((function(e){var t=e.archived,n=e.disabled;return!1===t&&!1===n||"edit"===c})).map((function(e,t){var n;return Object(R.jsxs)("div",{className:"questBox ".concat(e.state," ").concat(e.disabled?"disabled":""," ").concat(e.archived?"archived":""),onClick:function(){"none"===c&&"hidden"===e.state||m.push("/quests/".concat(e.id))},children:[Object(R.jsxs)("div",{className:"questHeader",children:[Object(R.jsxs)("div",{className:"questTitle",children:["none"===c&&"hidden"===e.state||null==e.title?"\ud83d\udd12 ???":"".concat("hidden"===e.state?"\ud83d\udd12 ":"").concat(e.title),"edit"===c&&Object(R.jsxs)(R.Fragment,{children:[" (",e.id,")"]})]}),Object(R.jsxs)("div",{className:"questPoints",children:["closed"!==e.state?e.maxXp:"".concat(e.xp," / ").concat(e.maxXp)," XP"]})]}),!("none"===c&&"hidden"===e.state)&&Object(R.jsx)("div",{className:"questDescription",children:ne(null!==(n=e.description)&&void 0!==n?n:"???")}),"hidden"===e.state&&Object(R.jsxs)("div",{className:"questDescription",children:["Ab Level ",e.minLevel]})]},t)}))]}),"edit"===c&&Object(R.jsx)("div",{className:"createQuestContainer",children:Object(R.jsx)("button",{onClick:Object(Q.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({title:"Neue Quest",description:"",maxXp:1,disabled:!0,minLevel:20,archived:!1});case 2:e.refetch();case 3:case"end":return t.stop()}}),t)}))),children:"+ Neue Quest"})}),v&&"loading ...",f&&Object(R.jsxs)(R.Fragment,{children:["Fehler: ",JSON.stringify(f)]})]})}function ne(e){return null==e?"???":e.length<100?e:e.substring(0,96)+" ..."}var ce=n(6),re=n(23),ae=n(37);n(56);function ie(e){var t=["qm-button"];return(e.disabled||e.loading)&&t.push("qm-button-disabled"),e.loading&&t.push("qm-button-loading"),Object(R.jsxs)("button",{className:t.join(" "),onClick:e.disabled||e.loading?void 0:e.onClick,children:[e.children,e.loading&&Object(R.jsxs)(R.Fragment,{children:[" ",Object(R.jsx)(ae.a,{className:"qm-loading-icon"})]})]})}function se(e){return Object(R.jsxs)("div",{className:"error",children:["Fehler: ","object"===typeof e.error?JSON.stringify(e.error):e.error]})}n(57);function oe(e){var t=Object(r.useState)(""),n=Object(A.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){var e=setTimeout((function(){a(c.length>=3?"":c+".")}),1e3);return function(){return clearTimeout(e)}}),[c,a]),Object(R.jsxs)("div",{className:"loading-component",children:["Laden ",c]})}n(58);function le(e){var t;return Object(R.jsx)("div",{className:"no-data",children:null!==(t=e.text)&&void 0!==t?t:"Keine Daten gefunden"})}n(59);function ue(e){var t,n,c,a,i=Object(u.h)().id,s=Object(u.g)(),o=T(i),l=o.data,d=o.error,j=o.isLoading,b=o.refetch,h=K(p),O=Object(r.useState)({title:"",description:"",maxXp:0,minLevel:0,xp:null,disabled:!1,archived:!1}),v=Object(A.a)(O,2),f=v[0],x=v[1],m=ee(),g=m.loading,k=m.error,N=m.post;Object(r.useEffect)((function(){b()}),[b]),Object(r.useEffect)((function(){var e,t,n,c;null!=l&&x({title:null!==(e=l.title)&&void 0!==e?e:"",description:null!==(t=l.description)&&void 0!==t?t:"",maxXp:l.maxXp,minLevel:l.minLevel,xp:l.xp,disabled:null!==(n=l.disabled)&&void 0!==n&&n,archived:null!==(c=l.archived)&&void 0!==c&&c})}),[l]);var w=Object(r.useCallback)(Object(Q.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==l){e.next=4;break}return e.next=3,N(Object(ce.a)({id:l.id},f));case 3:s.push("/quests");case 4:case"end":return e.stop()}}),e)}))),[N,l,f,s]),C=Object(r.useCallback)(Object(Q.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==l){e.next=4;break}return e.next=3,N({delete:!0,id:l.id});case 3:s.push("/quests");case 4:case"end":return e.stop()}}),e)}))),[N,l,s]);return null==l?Object(R.jsx)(le,{}):j?Object(R.jsx)(oe,{}):d?Object(R.jsx)(se,{error:d}):Object(R.jsxs)("div",{className:"questDetails",children:[Object(R.jsxs)("div",{className:"backArrowContainer",children:[Object(R.jsx)(re.a,{className:"backArrow",onClick:function(){return s.push("/quests")}}),Object(R.jsx)("div",{className:"value",children:"edit"===h?Object(R.jsx)("input",{value:f.title,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{title:e.target.value}))}}):null!==(t=l.title)&&void 0!==t?t:"-"})]}),Object(R.jsx)("div",{className:"label",children:"Beschreibung"}),Object(R.jsx)("div",{className:"value",children:"edit"===h?Object(R.jsx)("textarea",{rows:10,value:f.description,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{description:e.target.value}))}}):null!==(n=l.description)&&void 0!==n?n:"-"}),Object(R.jsx)("div",{className:"label",children:"Mindestens Level"}),Object(R.jsx)("div",{className:"value",children:"edit"===h?Object(R.jsx)("input",{type:"number",value:f.minLevel,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{minLevel:parseInt(e.target.value,10)}))}}):l.minLevel}),Object(R.jsx)("div",{className:"label",children:"Maximale XP"}),Object(R.jsx)("div",{className:"value",children:"edit"===h?Object(R.jsx)("input",{type:"number",value:f.maxXp,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{maxXp:parseInt(e.target.value,10)}))}}):l.maxXp}),Object(R.jsx)("div",{className:"label",children:"Erreichte XP"}),Object(R.jsx)("div",{className:"value",children:"edit"===h?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("input",{type:"number",value:null!==(c=f.xp)&&void 0!==c?c:"-",onChange:function(e){var t=parseInt(e.target.value,10);x(Object(ce.a)(Object(ce.a)({},f),{},{xp:t}))}}),Object(R.jsx)(ie,{onClick:function(){return x(Object(ce.a)(Object(ce.a)({},f),{},{xp:null}))},children:Object(R.jsx)(U.a,{})})]}):"closed"!==l.state?"-":l.xp}),"edit"===h&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"label",children:"Versteckt"}),Object(R.jsx)("div",{className:"value",children:Object(R.jsx)("input",{type:"checkbox",checked:f.disabled,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{disabled:e.target.checked}))}})}),Object(R.jsx)("div",{className:"label",children:"Archiviert"}),Object(R.jsx)("div",{className:"value",children:Object(R.jsx)("input",{type:"checkbox",checked:f.archived,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{archived:e.target.checked}))}})}),Object(R.jsxs)("div",{className:"buttonContainer",children:[Object(R.jsx)(ie,{loading:g,onClick:w,children:"Speichern"}),l.archived&&Object(R.jsx)("div",{className:"deleteContainer",children:Object(R.jsx)("button",{onClick:C,children:"Quest l\xf6schen"})}),null!==g&&void 0!==g?g:Object(R.jsx)(R.Fragment,{children:"loading..."}),k&&Object(R.jsx)(R.Fragment,{children:JSON.stringify(k)})]}),Object(R.jsx)("h4",{children:"Versionen"}),Object(R.jsx)("div",{className:"versionList",children:null===(a=l.versions)||void 0===a?void 0:a.map((function(e){var t=e.id,n=e.created_at,c=e.fields;return Object(R.jsxs)("div",{className:"versionItem",children:["Version ",t," vom ",new Intl.DateTimeFormat("de").format(new Date(n))," ",n.substring(11,19)," ",Object(R.jsx)("button",{onClick:function(){return x(Object(ce.a)(Object(ce.a)(Object(ce.a)({},f),c),{},{maxXp:c.max_xp,minLevel:c.min_level}))},children:"\ud83d\udd03"})]})}))})]})]})}var de=n(39);n(60);function je(e){var t=Object(r.useState)([]),n=Object(A.a)(t,2),c=n[0],a=n[1];Object(r.useEffect)((function(){a(e.levels.sort((function(e,t){return e.id-t.id})).map((function(e){return e.requiredXp})))}),[e.levels]);var i=Object(r.useCallback)((function(e){e<0||e>=c.length||a(c.filter((function(t,n){return n!==e})))}),[c,a]),s=Object(r.useCallback)((function(e,t){if(!(e<0||e>=c.length||t<0)){var n=c[e-1];if(!(null!=n&&n>=t)){var r=t-c[e];a(c.map((function(t,n){return e<=n?t+r:t})))}}}),[c,a]),o=function(){var e=Object(r.useState)(!1),t=Object(A.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(A.a)(a,2),s=i[0],o=i[1];return{loading:n,error:s,post:Object(r.useCallback)(function(){var e=Object(Q.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c(!0),e.next=4,fetch("".concat("localhost"===window.location.hostname?"http://localhost:3000":"","/api/levels"),{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o(e.t0);case 9:return e.prev=9,c(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[o,c])}}(),l=o.loading,u=o.error,d=o.post;return Object(R.jsxs)("div",{className:"levels-page",children:[Object(R.jsx)("h2",{children:"Levels"}),c.map((function(e,t){return Object(R.jsxs)("div",{className:"level-container",children:[Object(R.jsx)("div",{className:"level-index",children:t+1}),Object(R.jsx)("div",{className:"level-xp",children:Object(R.jsx)("input",{type:"number",value:e,onChange:function(e){return s(t,parseInt(e.target.value,10))}})}),Object(R.jsx)("div",{className:"level-delete",children:Object(R.jsx)("button",{onClick:function(){return i(t)},children:"L\xf6schen"})})]},t)})),Object(R.jsxs)("div",{className:"level-button-container",children:[Object(R.jsx)(ie,{onClick:function(){return a([].concat(Object(de.a)(c),[c[c.length-1]+1]))},loading:l,children:"Neues Level"}),Object(R.jsx)(ie,{onClick:function(){return d(c.map((function(e,t){return{id:t+1,requiredXp:e}})))},loading:l,children:"Speichern"})]}),l&&Object(R.jsx)(R.Fragment,{children:"loading..."}),u&&Object(R.jsxs)(R.Fragment,{children:["Error: ",JSON.stringify(u)]})]})}n(61);function be(e){var t=Object(i.e)(p),n=C(void 0),c=n.data,a=n.error,s=n.isLoading,o=n.refetch,l=S(),d=Object(A.a)(l,1)[0];Object(r.useEffect)((function(){return o()}),[o]);var j=Object(u.g)();return Object(R.jsxs)("div",{className:"rewards",children:[Object(R.jsx)("h2",{children:"Belohnungen"}),s&&Object(R.jsx)(oe,{}),a&&Object(R.jsx)("span",{className:"error",children:JSON.stringify(a)}),null!=c&&c.length>0?Object(R.jsx)("ul",{className:"rewards-list",children:null===c||void 0===c?void 0:c.filter((function(e){return!e.disabled||"edit"===t})).map((function(e,n){return Object(R.jsxs)("li",{className:"reward-item ".concat(!0===e.disabled?"disabled":"enabled"," ").concat(!0===e.locked?"locked":"unlocked"),onClick:function(){e.locked&&"none"===t||j.push("/rewards/".concat(e.id))},children:[Object(R.jsxs)("div",{className:"title",children:[e.locked&&"none"===t?"\ud83d\udd12 ???":e.title,"edit"===t&&Object(R.jsxs)(R.Fragment,{children:[" (",e.id,")"]})]}),Object(R.jsx)("div",{className:"description",children:e.locked&&"none"===t?"":e.description}),Object(R.jsxs)("div",{className:"min-level",children:["Ab Level ",e.minLevel]})]},n)}))}):Object(R.jsx)(le,{}),"edit"===t&&Object(R.jsx)("div",{className:"createQuestContainer",children:Object(R.jsx)("button",{onClick:Object(Q.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(void 0);case 1:case"end":return e.stop()}}),e)}))),children:"+ Neue Belohnung"})})]})}n(62);function he(e){var t,n,c,a=Object(u.h)().id,i=Object(u.g)(),s=y(a),o=s.data,l=s.error,d=s.isLoading,j=s.refetch,b=K(p);return Object(r.useEffect)((function(){j()}),[j]),d?Object(R.jsx)(oe,{}):null==o?Object(R.jsx)(le,{}):l?Object(R.jsx)(se,{error:l}):Object(R.jsxs)("div",{className:"reward-detail",children:[Object(R.jsxs)("div",{className:"reward-header",children:[Object(R.jsx)(re.a,{className:"back-arrow",onClick:function(){return i.push("/rewards")}}),Object(R.jsx)("div",{className:"reward-title",children:null!==(t=o.title)&&void 0!==t?t:"-"})]}),o.img&&Object(R.jsx)("img",{className:"reward-image",src:"".concat(o.img),alt:o.img}),Object(R.jsx)("div",{className:"reward-description",children:null!==(n=null===(c=o.description)||void 0===c?void 0:c.split(/\n/).map((function(e){return Object(R.jsx)("p",{children:e})})))&&void 0!==n?n:"-"}),"edit"===b&&Object(R.jsx)(ie,{onClick:function(){return i.push("/rewards/".concat(o.id,"/edit"))},children:Object(R.jsx)(U.b,{})})]})}n(63);function Oe(e){var t=Object(u.h)().id,n=Object(u.g)(),c=y(t),a=c.data,i=c.error,s=c.isLoading,o=c.refetch,l=L(),d=Object(A.a)(l,2),j=d[0],b=d[1].isLoading,h=K(p),O=Object(r.useState)(null!==a&&void 0!==a?a:{}),v=Object(A.a)(O,2),f=v[0],x=v[1];Object(r.useEffect)((function(){o()}),[o]),Object(r.useEffect)((function(){x(null!==a&&void 0!==a?a:{})}),[x,a]);var m=Object(r.useCallback)((function(){null!=a&&(j(Object(ce.a)(Object(ce.a)({},f),{},{id:a.id})),o(),n.push("/rewards/".concat(a.id)))}),[j,n,o,a,f]);return s?Object(R.jsx)(oe,{}):null==a?Object(R.jsx)(le,{}):i?Object(R.jsx)(se,{error:i}):"edit"!==h?Object(R.jsx)(R.Fragment,{children:"Keine Berechtigung"}):Object(R.jsxs)("div",{className:"reward-edit",children:[Object(R.jsxs)("div",{className:"reward-header",children:[Object(R.jsx)(re.a,{className:"back-arrow",onClick:function(){return n.push("/rewards")}}),Object(R.jsx)("div",{className:"reward-title",children:Object(R.jsx)("input",{value:f.title,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{title:e.target.value}))}})})]}),"Image: ",Object(R.jsx)("input",{value:f.img,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{img:e.target.value}))}}),Object(R.jsx)("div",{className:"reward-description",children:Object(R.jsx)("textarea",{rows:10,value:f.description,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{description:e.target.value}))}})}),"Min-Level: ",Object(R.jsx)("input",{type:"number",value:f.minLevel,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{minLevel:parseInt(e.target.value,10)}))}}),"Versteckt: ",Object(R.jsx)("input",{type:"checkbox",checked:f.disabled,onChange:function(e){return x(Object(ce.a)(Object(ce.a)({},f),{},{disabled:e.target.checked}))}}),Object(R.jsx)(ie,{onClick:m,loading:b,children:"Speichern"})]})}var ve=n(38);n(64);function fe(e){var t=K(f),n=K(p),c=H(),a=Object(r.useState)(""),i=Object(A.a)(a,2),s=i[0],o=i[1],l=Object(r.useState)(""),u=Object(A.a)(l,2),d=u[0],j=u[1],b=Object(r.useState)("/quests"),h=Object(A.a)(b,2),O=h[0],x=h[1];return Object(R.jsxs)("div",{className:"settings",children:[Object(R.jsx)("h2",{children:"Einstellungen"}),Object(R.jsxs)("div",{className:"push",children:[Object(R.jsx)("h3",{children:"Push-Benachrichtigungen"}),Object(R.jsx)("input",{className:"push-permission",type:"checkbox",checked:"granted"===e.userConsent,onChange:Object(Q.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onClickAskUserPermission();case 2:return t.next=4,e.onClickSusbribeToPushNotification();case 4:case"end":return t.stop()}}),t)})))}),"Benachrichtigungen erlauben",Object(R.jsx)(pe,{error:e.error}),"edit"===n&&Object(R.jsxs)("div",{className:"push-form",children:[Object(R.jsx)("h4",{className:"form-title",children:"Benutzerdefinierte Benachrichtigung"}),Object(R.jsx)("div",{className:"label",children:"Titel"}),Object(R.jsx)("div",{className:"value",children:Object(R.jsx)("input",{value:s,onChange:function(e){var t;return o(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(R.jsx)("div",{className:"label",children:"Text"}),Object(R.jsx)("div",{className:"value",children:Object(R.jsx)("input",{value:d,onChange:function(e){var t;return j(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(R.jsx)("div",{className:"label",children:"Url"}),Object(R.jsx)("div",{className:"value",children:Object(R.jsx)("input",{value:O,onChange:function(e){var t;return x(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(R.jsx)("div",{className:"submit",children:Object(R.jsx)(ie,{onClick:function(){return e.onClickSendNotification({title:s,text:d,url:O})},loading:e.loading,children:Object(R.jsxs)(R.Fragment,{children:["Senden ",Object(R.jsx)(ve.a,{})]})})})]})]}),Object(R.jsxs)("div",{className:"permission",children:[Object(R.jsx)("h3",{children:"Berechtigung"}),Object(R.jsxs)("span",{children:["Rolle: ",n]}),Object(R.jsxs)("div",{className:"token",children:["Token: ",Object(R.jsx)("input",{value:t,onChange:function(e){return c(v(e.target.value))}})]})]})]})}var pe=function(e){var t=e.error;return t?Object(R.jsxs)("section",{className:"app-error",children:[Object(R.jsx)("h2",{children:t.name}),Object(R.jsxs)("p",{children:["Error message : ",t.message]}),Object(R.jsxs)("p",{children:["Error code : ",t.code]})]}):null};n(65);function xe(e){var t=function(e){var t=Object(r.useState)(!1),n=Object(A.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(void 0),s=Object(A.a)(i,2),o=s[0],l=s[1],u=Object(r.useState)(void 0),d=Object(A.a)(u,2),j=d[0],b=d[1],h=Object(r.useCallback)((function(){Object(Q.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(!0),t.t0=l,t.next=5,B(e);case 5:t.t1=t.sent,(0,t.t0)(t.t1),b(void 0),t.next=15;break;case 10:t.prev=10,t.t2=t.catch(0),console.log(t.t2),l(void 0),b("Upps ein Fehler ist aufgetreten.");case 15:return t.prev=15,a(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,10,15,18]])})))()}),[e]);return Object(r.useEffect)(h,[h]),{data:o,error:j,loading:c,refetch:h}}(),n=t.data,c=t.error,a=t.loading,i=t.refetch,s=$(),o=s.userConsent,l=s.userSubscription,d=s.onClickAskUserPermission,j=s.onClickSusbribeToPushNotification,b=s.onClickSendSubscriptionToPushServer,h=s.onClickSendNotification,O=s.loading,v=s.error;return Object(r.useEffect)((function(){console.log("update push subscription"),"granted"===o&&null!=l&&b()}),[o,l,b]),Object(R.jsxs)("div",{className:"game",children:[Object(R.jsx)(J,{data:n}),Object(R.jsxs)("div",{className:"game-main",children:[a&&Object(R.jsx)(R.Fragment,{children:"Laden ..."}),c&&Object(R.jsx)(R.Fragment,{children:"string"===typeof c?c:JSON.stringify(c)}),n&&Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(u.d,{children:[Object(R.jsx)(u.b,{path:"/levels",exact:!0,children:Object(R.jsx)(je,{levels:n.levels})}),Object(R.jsx)(u.b,{path:"/quests",exact:!0,children:Object(R.jsx)(te,{quests:n.quests,refetch:i})}),Object(R.jsx)(u.b,{path:"/quests/:id",exact:!0,children:Object(R.jsx)(ue,{})}),Object(R.jsx)(u.b,{path:"/rewards",exact:!0,children:Object(R.jsx)(be,{refetch:i})}),Object(R.jsx)(u.b,{path:"/rewards/:id",exact:!0,children:Object(R.jsx)(he,{})}),Object(R.jsx)(u.b,{path:"/rewards/:id/edit",exact:!0,children:Object(R.jsx)(Oe,{})}),Object(R.jsx)(u.b,{path:"/settings",children:Object(R.jsx)(fe,{userConsent:o,onClickAskUserPermission:d,onClickSusbribeToPushNotification:j,onClickSendNotification:h,loading:O,error:v})})]})})]}),Object(R.jsx)(u.b,{path:"/",component:W})]})}n(66);function me(){var e=H();return Object(r.useEffect)((function(){var t=function(){try{var e,t=null!==(e=new URLSearchParams(window.location.search).get("token"))&&void 0!==e?e:h.a.get("token");return null!==t&&void 0!==t?t:void 0}catch(n){return void console.warn("Error loading the permission token from url or cookie: ",JSON.stringify(n))}}();null!=t&&e(v(t))}),[e]),Object(R.jsx)("div",{className:"app",onTouchMove:function(e){return console.log(e)},children:Object(R.jsx)(xe,{})})}var ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};o.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(i.a,{store:P,children:Object(R.jsxs)(l.a,{children:[Object(R.jsx)(u.b,{path:"/",exact:!0,component:function(){return Object(R.jsx)(u.a,{to:"/quests"})}}),Object(R.jsx)(me,{})]})})}),document.getElementById("root")),ge()}},[[67,1,2]]]);
//# sourceMappingURL=main.0f98c3a5.chunk.js.map