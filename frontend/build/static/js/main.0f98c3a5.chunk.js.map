{"version":3,"sources":["model/permissionReducer.ts","model/services/rewards.ts","model/services/quest.ts","model/store.ts","api/useData.ts","pages/Game/GameHeader.tsx","model/hooks.ts","pages/Game/GameFooter.tsx","push-notification/http.ts","push-notification/push-notifications.ts","push-notification/usePushNotifications.ts","api/usePostQuest.ts","pages/Quests/index.tsx","components/Button/index.tsx","components/Error/index.tsx","components/Loading/index.tsx","components/NoData/index.tsx","pages/QuestDetail/index.tsx","pages/Levels/index.tsx","api/usePostLevels.ts","pages/Rewards/index.tsx","pages/RewardDetail/index.tsx","pages/RewardEdit/index.tsx","pages/Settings/index.tsx","pages/Game/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["permissionSlice","createSlice","name","initialState","token","permission","reducers","changeToken","state","action","payload","Cookies","get","set","sameSite","expires","actions","selectToken","selectPermission","rewardsApi","createApi","reducerPath","baseQuery","fetchBaseQuery","baseUrl","tagTypes","endpoints","build","getRewards","query","getReward","arg","createReward","mutation","url","method","invalidatesTags","updateReward","id","patch","body","useGetRewardsQuery","useGetRewardQuery","useCreateRewardMutation","useUpdateRewardMutation","questApi","builder","getQuest","useGetQuestQuery","store","configureStore","reducer","permissionReducer","middleware","getDefaultMiddleware","concat","setupListeners","dispatch","getData","path","a","fetch","res","status","json","console","error","statusText","text","Error","GameHeader","props","className","data","currentLevel","maxLevel","Progress","current","xpWithinCurrentLevel","max","xpToNextLevel","ratio","style","width","useAppDispatch","useDispatch","useAppSelector","useSelector","GameFooter","gridTemplateColumns","undefined","to","pathname","search","location","http","post","credentials","headers","JSON","stringify","mode","then","response","pushServerPublicKey","Notification","requestPermission","navigator","serviceWorker","ready","pushManager","subscribe","userVisibleOnly","applicationServerKey","getUserSubscription","getSubscription","pushSubscription","pushNotificationSupported","window","usePushNotifications","useState","userConsent","setUserConsent","userSubscription","setUserSubscription","pushServerSubscriptionId","setPushServerSubscriptionId","setError","loading","setLoading","useEffect","register","registerServiceWorker","existingSubscription","getExixtingSubscription","onClickAskUserPermission","useCallback","askUserPermission","consent","message","code","onClickSusbribeToPushNotification","createNotificationSubscription","subscrition","catch","err","onClickSendSubscriptionToPushServer","log","onClickSendNotification","usePostQuest","values","hostname","cache","referrerPolicy","Quests","quests","refetch","filterList","setFilterList","filterArchivedList","setFilterArchivedList","history","useHistory","type","checked","onChange","evt","target","filter","archived","disabled","map","quest","index","onClick","push","title","maxXp","xp","formatDescription","description","minLevel","length","substring","Button","classes","join","children","Loading","dots","setDots","setTimeout","clearTimeout","NoData","QuestDetails","useParams","errorGet","isLoadingGet","isLoading","setValues","onSave","onDelete","delete","value","rows","parseInt","versions","created_at","fields","Intl","DateTimeFormat","format","Date","max_xp","min_level","Levels","levels","sort","b","requiredXp","deleteElement","i","changeElement","valueNew","valueBefore","diff","usePostLevels","Rewards","item","locked","RewardDetails","reward","img","src","alt","split","part","RewardEdit","isUpdating","Settings","setTitle","setText","setUrl","Game","setData","useData","pushLoading","pushError","exact","component","App","URLSearchParams","warn","getPermissionTokenFromUrlOrCookie","onTouchMove","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0f98c3a5.chunk.js","sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport Cookies from \"js-cookie\";\nimport type { RootState } from \"./store\";\n\nexport type Permission = \"none\" | \"view\" | \"edit\";\n\ninterface PermissionState {\n  token: string;\n  permission: Permission\n}\n\n// Define the initial state using that type\nconst initialState: PermissionState = {\n  token: \"\",\n  permission: \"none\"\n}\n\nconst EDIT_TOKEN = \"broiler\";\nconst VIEW_TOKEN = \"fittie\";\n\nexport const permissionSlice = createSlice({\n  name: \"permission\",\n  // `createSlice` will infer the state type from the `initialState` argument\n  initialState,\n  reducers: {\n    changeToken: (state, action: PayloadAction<string>) => {\n      const token = action.payload;\n      state.token = token;\n\n      if (Cookies.get(\"token\") !== token) {\n        Cookies.set(\"token\", token, { sameSite: \"lax\", expires: 30 });\n      }\n\n      switch (token) {\n        case EDIT_TOKEN:\n          state.permission = \"edit\";\n          break;\n        case VIEW_TOKEN:\n          state.permission = \"view\";\n          break;\n        default:\n          state.permission = \"none\";\n          break;\n      }\n    }\n  }\n})\n\nexport const { changeToken } = permissionSlice.actions;\n\nexport const selectToken = (state: RootState) => state.permission.token;\nexport const selectPermission = (state: RootState) => state.permission.permission;\n\nexport default permissionSlice.reducer;\n","import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\n\nexport interface Reward {\n  id: number;\n  title: string;\n  description: string;\n  minLevel: number;\n  disabled: boolean;\n  locked: boolean;\n  img?: string;\n}\n\nexport const rewardsApi = createApi({\n  reducerPath: \"rewardsApi\",\n  baseQuery: fetchBaseQuery({ baseUrl: \"/api/\" }),\n  tagTypes: [\"Reward\"],\n  endpoints: (build) => ({\n    getRewards: build.query<Reward[], undefined>({\n      query: () => \"rewards\"\n    }),\n    getReward: build.query<Reward, string>({\n      query: (arg) => `rewards/${arg}`\n    }),\n    createReward: build.mutation<undefined, undefined>({\n      query: () => ({\n        url: \"rewards\",\n        method: 'POST',\n      }),\n      invalidatesTags: [\"Reward\"],\n    }),\n    updateReward: build.mutation<undefined, Partial<Reward> & Pick<Reward, 'id'>>({\n      query: ({ id, ...patch }) => ({\n        url: `rewards/${id}`,\n        method: 'PATCH',\n        body: patch,\n      }),\n      invalidatesTags: [\"Reward\"],\n    }),\n  })\n});\n\nexport const { useGetRewardsQuery, useGetRewardQuery, useCreateRewardMutation, useUpdateRewardMutation } = rewardsApi;\n","import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\n\nexport interface Quest {\n  id: string;\n  title: string;\n  description: string;\n  maxXp: number;\n  xp: number | null;\n  minLevel: number;\n  disabled: boolean;\n  archived: boolean;\n  state: state;\n  versions?: Version[];\n}\n\nexport interface Version {\n  id: number;\n  quest_id: number;\n  created_at: string;\n  fields: any;\n}\n\nexport type state = \"open\" | \"closed\" | \"hidden\";\n\nexport const questApi = createApi({\n  reducerPath: \"questApi\",\n  baseQuery: fetchBaseQuery({ baseUrl: \"/api/\" }),\n  endpoints: (builder) => ({\n    getQuest: builder.query<Quest, string>({\n      query: (arg) => `quests/${arg}`\n    })\n  })\n});\n\nexport const { useGetQuestQuery } = questApi;\n","import { configureStore } from \"@reduxjs/toolkit\"\nimport permissionReducer from \"./permissionReducer\";\nimport { setupListeners } from \"@reduxjs/toolkit/query/react\";\nimport { rewardsApi } from \"./services/rewards\";\nimport { questApi } from \"./services/quest\";\n\nexport const store = configureStore({\n  reducer: {\n    permission: permissionReducer,\n    [rewardsApi.reducerPath]: rewardsApi.reducer,\n    [questApi.reducerPath]: questApi.reducer\n  },\n  middleware: (getDefaultMiddleware) =>    getDefaultMiddleware().concat(rewardsApi.middleware).concat(questApi.middleware),\n});\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n\nsetupListeners(store.dispatch);\n","import { useCallback, useEffect, useState } from \"react\";\n\nexport type questState = \"open\" | \"closed\" | \"hidden\";\n\nexport interface Quest {\n  id: string;\n  title: string;\n  description: string;\n  maxXp: number;\n  xp: number | null;\n  minLevel: number;\n  disabled: boolean;\n  archived: boolean;\n  state: questState;\n  versions?: Version[];\n}\n\nexport interface Version {\n  id: number;\n  quest_id: number;\n  created_at: string;\n  fields: any;\n}\n\nexport interface Level {\n  id: number;\n  requiredXp: number;\n}\n\nexport interface Data {\n  maxLevel: number;\n  currentLevel: number;\n  currentXp: number;\n  xpWithinCurrentLevel: number;\n  xpToNextLevel: number;\n  quests: Quest[];\n  levels: Level[];\n}\n\nasync function getData<T = Data>(path?: string): Promise<T> {\n  const res = await fetch(path ?? \"/api/data\");\n  if (res.status === 200) return res.json();\n  console.error(`Fetch error: ${res.status} ${res.statusText} ${res.text()}`);\n  throw new Error(res.statusText);\n}\n\nexport function useData<T = Data>(path?: string): { data?: T; error?: any; loading: boolean; refetch: () => void } {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [data, setData] = useState<T | undefined>(undefined);\n  const [error, setError] = useState<any | undefined>(undefined);\n\n  const refetch = useCallback(() => {\n    (async () => {\n      try {\n        setLoading(true);\n        setData(await getData(path));\n        setError(undefined);\n      } catch (err) {\n        console.log(err);\n        setData(undefined);\n        setError(\"Upps ein Fehler ist aufgetreten.\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [path]);\n\n  useEffect(refetch, [refetch]);\n\n  return { data, error, loading, refetch };\n}\n","import React from \"react\";\nimport { Data } from \"../../api/useData\";\nimport \"./GameHeader.css\";\n\nexport default function GameHeader(props: { data?: Data }): JSX.Element {\n  return (\n    <div className=\"gameHeader\">\n      <div className=\"gameHeaderTitle\">Quest Master</div>\n      <div className=\"gameHeaderLevel\">\n        Level {props.data?.currentLevel ?? 1} / {props.data?.maxLevel ?? \"?\"}\n      </div>\n      <Progress current={props.data?.xpWithinCurrentLevel ?? 0} max={(props.data?.xpToNextLevel ?? 0) + (props.data?.xpWithinCurrentLevel ?? 1)} />\n    </div>\n  );\n}\n\nfunction Progress(props: { max: number; current: number }): JSX.Element {\n  const ratio = 100 * props.current / props.max;\n\n  return (\n    <div className=\"gameProgressContainer\">\n      <div className=\"gameProgressBar\">\n        <div style={{ width: `${ratio}%` }} className=\"gameProgressCurrent\">\n          <div className=\"gameProgressCurrentText\">\n            {props.current}\n          </div>\n        </div>\n      </div>\n      {props.max}â†‘\n    </div>\n  )\n}\n","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\nimport type { RootState, AppDispatch } from './store'\n\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import React from \"react\";\nimport { Link, RouteChildrenProps } from \"react-router-dom\";\nimport { AiFillTrophy, AiFillSetting } from \"react-icons/ai\"\nimport { FaTasks } from \"react-icons/fa\"\nimport { RiFilePaper2Fill } from \"react-icons/ri\"\nimport { useAppSelector } from \"../../model/hooks\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport \"./GameFooter.css\";\n\nexport default function GameFooter(props: RouteChildrenProps): JSX.Element {\n  const permission = useAppSelector(selectPermission);\n\n  return (\n    <div className=\"gameFooter\" style={permission === \"edit\" ? { gridTemplateColumns: \"auto auto auto auto\" } : undefined }>\n      <Link to={{ pathname: \"/quests\", search: props.location.search }}>\n        <FaTasks />\n      </Link>\n      <Link to={{ pathname: \"/rewards\", search: props.location.search }}>\n        <AiFillTrophy />\n      </Link>\n      {\n        permission === \"edit\" && (\n          <Link to={{ pathname: \"/levels\", search: props.location.search }}>\n            <RiFilePaper2Fill />\n          </Link>\n        )\n      }\n      <Link to={{ pathname: \"/settings\", search: props.location.search }}>\n        <AiFillSetting />\n      </Link>\n    </div>\n  );\n}\n","function post(path: string, body: any) {\n  return fetch(path, {\n    credentials: \"omit\",\n    headers: { \"content-type\": \"application/json;charset=UTF-8\", \"sec-fetch-mode\": \"cors\" },\n    body: JSON.stringify(body),\n    method: \"POST\",\n    mode: \"cors\"\n  })\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function(data) {\n      return data;\n    });\n}\n\nfunction get(path: string) {\n  return fetch(path, {\n    credentials: \"omit\",\n    headers: { \"content-type\": \"application/json;charset=UTF-8\", \"sec-fetch-mode\": \"cors\" },\n    method: \"GET\",\n    mode: \"cors\"\n  })\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function(data) {\n      return data;\n    });\n}\n\nconst http = {\n  post: post,\n  get: get\n};\n\nexport default http;\n","const pushServerPublicKey = \"BDTxsv_QJLLjMkKfKrZw9kLADmciH2_E1B4Smkp9kbOLHWlrNs_3jFZA3zCyYbw9GRKq5hoEhkcHiBMf8OiGKDQ\";\n\n/**\n * checks if Push notification and service workers are supported by your browser\n */\nfunction isPushNotificationSupported() {\n  return \"serviceWorker\" in navigator && \"PushManager\" in window;\n}\n\n/**\n * asks user consent to receive push notifications and returns the response of the user, one of granted, default, denied\n */\nasync function askUserPermission() {\n  return await Notification.requestPermission();\n}\n/**\n * shows a notification\n */\nfunction sendNotification() {\n  // const img = \"/images/jason-leung-HM6TMmevbZQ-unsplash.jpg\";\n  const text = \"Take a look at this brand new t-shirt!\";\n  const title = \"New Product Available\";\n  const options = {\n    body: text,\n    // icon: \"/images/jason-leung-HM6TMmevbZQ-unsplash.jpg\",\n    vibrate: [200, 100, 200],\n    tag: \"new-product\",\n    // image: img,\n    badge: \"https://spyna.it/icons/android-icon-192x192.png\",\n    actions: [{ action: \"Detail\", title: \"View\", icon: \"https://via.placeholder.com/128/ff0000\" }]\n  };\n  navigator?.serviceWorker?.ready.then(function(serviceWorker) {\n    serviceWorker.showNotification(title, options);\n  });\n}\n\n/**\n *\n */\nfunction registerServiceWorker() {\n  return navigator?.serviceWorker?.register(\"/sw.js\");\n}\n\n/**\n *\n * using the registered service worker creates a push notification subscription and returns it\n *\n */\nasync function createNotificationSubscription() {\n  //wait for service worker installation to be ready\n  const serviceWorker = await navigator?.serviceWorker?.ready;\n  // subscribe and return the subscription\n  return await serviceWorker.pushManager.subscribe({\n    userVisibleOnly: true,\n    applicationServerKey: pushServerPublicKey\n  });\n}\n\n/**\n * returns the subscription if present or nothing\n */\nfunction getUserSubscription(): Promise<PushSubscription | null> {\n  //wait for service worker installation to be ready, and then\n  return navigator?.serviceWorker?.ready\n    .then(function(serviceWorker) {\n      return serviceWorker.pushManager.getSubscription();\n    })\n    .then(function(pushSubscription) {\n      return pushSubscription;\n    });\n}\n\nexport {\n  isPushNotificationSupported,\n  askUserPermission,\n  registerServiceWorker,\n  sendNotification,\n  createNotificationSubscription,\n  getUserSubscription\n};","import { useState, useEffect, useCallback } from \"react\";\nimport http from \"./http\";\n\n// https://itnext.io/react-push-notifications-with-hooks-d293d36f4836\n// https://github.com/Spyna/push-notification-demo\n\nimport {\n  isPushNotificationSupported,\n  askUserPermission,\n  registerServiceWorker,\n  createNotificationSubscription,\n  getUserSubscription\n} from \"./push-notifications\";\n\nconst pushNotificationSupported = isPushNotificationSupported();\n\nexport interface PushPayload {\n  title: string;\n  text: string;\n  url: string;\n}\n\nexport default function usePushNotifications() {\n  const [userConsent, setUserConsent] = useState(Notification.permission);\n  const [userSubscription, setUserSubscription] = useState<PushSubscription | null>(null);\n  const [pushServerSubscriptionId, setPushServerSubscriptionId] = useState();\n  const [error, setError] = useState<any | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (pushNotificationSupported) {\n      setLoading(true);\n      setError(false);\n      registerServiceWorker().then(() => {\n        setLoading(false);\n      });\n    }\n  }, []);\n  \n  useEffect(() => {\n    setLoading(true);\n    setError(false);\n    const getExixtingSubscription = async () => {\n      const existingSubscription = await getUserSubscription();\n      setUserSubscription(existingSubscription);\n      setLoading(false);\n    };\n    getExixtingSubscription();\n  }, []);\n\n  const onClickAskUserPermission = useCallback(() => {\n    setLoading(true);\n    setError(false);\n    return askUserPermission().then(consent => {\n      setUserConsent(consent);\n      if (consent !== \"granted\") {\n        setError({\n          name: \"Consent denied\",\n          message: \"You denied the consent to receive notifications\",\n          code: 0\n        });\n      }\n      setLoading(false);\n    });\n  }, [setLoading, setError, setUserConsent]);\n\n  const onClickSusbribeToPushNotification = useCallback(() => {\n    setLoading(true);\n    setError(false);\n    return createNotificationSubscription()\n      .then(function(subscrition) {\n        setUserSubscription(subscrition);\n        setLoading(false);\n      })\n      .catch(err => {\n        console.error(\"Couldn't create the notification subscription\", err, \"name:\", err.name, \"message:\", err.message, \"code:\", err.code);\n        setError(err);\n        setLoading(false);\n      });\n  }, [setLoading, setError, setUserSubscription]);\n\n  const onClickSendSubscriptionToPushServer = useCallback(() => {\n    if (userSubscription == null || userConsent !== \"granted\") {\n      console.log(\"No userSubscription present or consent not given\");\n      return;\n    }\n    setLoading(true);\n    setError(false);\n    http\n      .post(\"/api/subscription\", userSubscription)\n      .then((response: any) => {\n        setPushServerSubscriptionId(response.id);\n        setLoading(false);\n      })\n      .catch((err: any) => {\n        setLoading(false);\n        setError(err);\n      });\n  }, [userSubscription, userConsent, setLoading, setError, setPushServerSubscriptionId]);\n\n  const onClickSendNotification = useCallback(async (payload: PushPayload) => {\n    setLoading(true);\n    setError(false);\n    await http\n      .post(`/api/custom-subscription`, payload)\n      .catch((err: any) => {\n        setLoading(false);\n        setError(err);\n      });\n    setLoading(false);\n  }, [setLoading, setError]);\n\n  return {\n    onClickAskUserPermission,\n    onClickSusbribeToPushNotification,\n    onClickSendSubscriptionToPushServer,\n    pushServerSubscriptionId,\n    onClickSendNotification,\n    userConsent,\n    pushNotificationSupported,\n    userSubscription,\n    error,\n    loading\n  };\n}\n","import { useCallback, useState } from \"react\";\n\ninterface Values {\n  id?: string;\n  title: string;\n  description: string;\n  maxXp: number;\n  minLevel: number;\n  disabled: boolean;\n  archived: boolean;\n}\n\nexport function usePostQuest() {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<any | null>(null);\n\n  const post = useCallback(async (values: Values | { delete: true; id: string }) => {\n    try {\n      setLoading(true);\n      await fetch(`${window.location.hostname === \"localhost\" ? \"http://localhost:3000\" : \"\"}/api/quest`, {\n        method: \"POST\",\n        mode: \"no-cors\",\n        cache: 'no-cache',\n        credentials: \"same-origin\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        referrerPolicy: 'no-referrer',\n        body: JSON.stringify(values)\n      })\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [setError, setLoading]);\n\n  return { loading, error, post };\n}\n","import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Cookies from \"js-cookie\";\nimport { Quest } from \"../../api/useData\";\nimport { usePostQuest } from \"../../api/usePostQuest\";\nimport { useAppSelector } from \"../../model/hooks\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport \"./styles.scss\";\n\nexport default function Quests(props: { quests: Quest[]; refetch: () => void }): JSX.Element {\n  const { quests, refetch } = props;\n  const permission = useAppSelector(selectPermission);\n\n  const [filterList, setFilterList] = useState<boolean>(Cookies.get(\"filterList\") != null ? Cookies.get(\"filterList\") === \"true\" : true);\n  const [filterArchivedList, setFilterArchivedList] = useState<boolean>(Cookies.get(\"filterArchivedList\") != null ? Cookies.get(\"filterArchivedList\") === \"true\" : false);\n\n  const { loading, error, post } = usePostQuest();\n\n  const history = useHistory();\n\n  useEffect(() => refetch(), [refetch]);\n\n  return (\n    <>\n      <div className=\"questList\">\n        <div className=\"questFilter\">\n          <input type=\"checkbox\" checked={filterList} onChange={(evt) => {\n            setFilterList(evt.target.checked);\n            Cookies.set(\"filterList\", `${evt.target.checked}`);\n          }} />Erledigte Quests\n        </div>\n        {permission === \"edit\" && (\n          <div className=\"questFilter\">\n            <input type=\"checkbox\" checked={filterArchivedList} onChange={(evt) => {\n              setFilterArchivedList(evt.target.checked);\n              Cookies.set(\"filterArchivedList\", `${evt.target.checked}`);\n            }} />Archivierte Quests\n          </div>\n        )}\n        {quests\n          .filter(({ state }) => filterList === true ? true : state !== \"closed\")\n          .filter(({ archived }) => filterArchivedList === true ? true : archived === false)\n          .filter(({ archived, disabled }) => (archived === false && disabled === false) || permission === \"edit\")\n          .map((quest, index) => (\n            <div\n              key={index}\n              className={`questBox ${quest.state} ${quest.disabled ? \"disabled\" : \"\"} ${quest.archived ? \"archived\" : \"\"}`}\n              onClick={() => {\n                if (!(permission === \"none\" && quest.state === \"hidden\")) history.push(`/quests/${quest.id}`);\n              }}\n            >\n              <div className=\"questHeader\">\n                <div className=\"questTitle\">\n                  {(permission === \"none\" && quest.state === \"hidden\") || quest.title == null ? \"ðŸ”’ ???\" : `${quest.state === \"hidden\" ? \"ðŸ”’ \" : \"\"}${quest.title}`}\n                  {permission === \"edit\" && <> ({quest.id})</>}\n                </div>\n                <div className=\"questPoints\">\n                  {\n                    quest.state !== \"closed\" ? quest.maxXp : `${quest.xp} / ${quest.maxXp}`\n                  } XP\n                </div>\n              </div>\n              {\n                !(permission === \"none\" && quest.state === \"hidden\") && <div className=\"questDescription\">{formatDescription(quest.description ?? \"???\")}</div>\n              }\n              {\n                quest.state === \"hidden\" && <div className=\"questDescription\">Ab Level {quest.minLevel}</div>\n              }\n            </div>\n        ))}\n      </div>\n      {permission === \"edit\" && (\n        <div className=\"createQuestContainer\">\n          <button onClick={async () => {\n            await post({ title: \"Neue Quest\", description: \"\", maxXp: 1, disabled: true, minLevel: 20, archived: false });\n            props.refetch();\n          }}>\n            + Neue Quest\n          </button>\n        </div>\n      )}\n      {loading && \"loading ...\"}\n      {error && <>Fehler: {JSON.stringify(error)}</>}\n    </>\n  );\n}\n\nfunction formatDescription(description?: string): string {\n  if (description == null) return \"???\";\n  if (description.length < 100) return description;\n  return description.substring(0, 96) + \" ...\";\n}\n","import React from \"react\";\nimport { VscLoading } from \"react-icons/vsc\";\nimport \"./styles.scss\";\n\nexport interface ButtonProps {\n  onClick?: () => void;\n  loading?: boolean;\n  disabled?: boolean;\n  children?: string | JSX.Element\n}\n\nexport default function Button(props: ButtonProps): JSX.Element {\n  const classes = [\"qm-button\"];\n  if (props.disabled || props.loading) classes.push(\"qm-button-disabled\");\n  if (props.loading) classes.push(\"qm-button-loading\");\n\n  return (\n    <button className={classes.join(\" \")} onClick={props.disabled ||Â props.loading ? undefined : props.onClick}>\n      {props.children}{props.loading && <> <VscLoading className=\"qm-loading-icon\" /></>}\n    </button>\n  );\n}\n","import React from \"react\";\n\nexport default function Error(props: { error: any }): JSX.Element {\n  return (\n    <div className=\"error\">\n      Fehler: {typeof props.error === \"object\" ? JSON.stringify(props.error) : props.error}\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport \"./styles.scss\";\n\nconst MS = 1000;\n\nexport default function Loading(props: object): JSX.Element {\n  const [dots, setDots] = useState(\"\");\n\n  useEffect(() => {\n    const id = setTimeout(() => {\n      setDots(dots.length >= 3 ? \"\" : dots + \".\");\n    }, MS);\n    return () => clearTimeout(id);\n  }, [dots, setDots]);\n\n  return (\n    <div className=\"loading-component\">\n      Laden {dots}\n    </div>\n  );\n}\n","import React from \"react\";\nimport \"./styles.scss\";\n\ninterface NoDataProps {\n  text?: string;\n}\n\nexport default function NoData(props: NoDataProps): JSX.Element {\n  return (\n    <div className=\"no-data\">\n      {props.text ?? \"Keine Daten gefunden\"}\n    </div>\n  )\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { AiFillDelete } from \"react-icons/ai\";\nimport { BiArrowBack } from \"react-icons/bi\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { usePostQuest } from \"../../api/usePostQuest\";\nimport Button from \"../../components/Button\";\nimport Error from \"../../components/Error\";\nimport Loading from \"../../components/Loading\";\nimport NoData from \"../../components/NoData\";\nimport { useAppSelector } from \"../../model/hooks\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport { useGetQuestQuery } from \"../../model/services/quest\";\nimport \"./styles.scss\";\n\ninterface Values {\n  title: string;\n  description: string;\n  maxXp: number;\n  minLevel: number;\n  xp: number | null;\n  disabled: boolean;\n  archived: boolean;\n}\n\nexport default function QuestDetails(props: object): JSX.Element {\n  const { id } = useParams<{ id: string }>();\n  const history = useHistory();\n  const { data: quest, error: errorGet, isLoading: isLoadingGet, refetch } = useGetQuestQuery(id); \n  const permission = useAppSelector(selectPermission);\n\n  const [values, setValues] = useState<Values>({ title: \"\", description: \"\", maxXp: 0, minLevel: 0, xp: null, disabled: false, archived: false });\n\n  const { loading, error, post } = usePostQuest();\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  useEffect(() => {\n    if (quest != null) {\n      setValues({\n        title: quest.title ?? \"\",\n        description: quest.description ?? \"\",\n        maxXp: quest.maxXp,\n        minLevel: quest.minLevel,\n        xp: quest.xp,\n        disabled: quest.disabled ?? false,\n        archived: quest.archived ?? false\n      })\n    }\n  }, [quest]);\n\n  const onSave = useCallback(async () => {\n    if (quest != null) {\n      await post({ id: quest.id, ...values });\n      history.push(\"/quests\");\n    }\n  }, [post, quest, values, history]);\n\n  const onDelete = useCallback(async () => {\n    if (quest != null) {\n      await post({ delete: true, id: quest.id });\n      history.push(\"/quests\");\n    }\n  }, [post, quest, history]);\n\n  if (quest == null) return <NoData />;\n  if (isLoadingGet) return <Loading />;\n  if (errorGet) return <Error error={errorGet} />\n\n  return <div className=\"questDetails\">\n    <div className=\"backArrowContainer\" >\n      <BiArrowBack className=\"backArrow\" onClick={() => history.push(\"/quests\")} />\n      <div className=\"value\">\n        {\n          permission === \"edit\"\n          ?\n          (<input value={values.title} onChange={(evt) => setValues({ ...values, title: evt.target.value })} />)\n          :\n          quest.title ?? \"-\"\n        }\n      </div>\n    </div>\n    <div className=\"label\">\n      Beschreibung\n    </div>\n    <div className=\"value\">\n      {\n        permission === \"edit\"\n        ?\n        (<textarea rows={10} value={values.description} onChange={(evt) => setValues({ ...values, description: evt.target.value })} />)\n        :\n        quest.description ?? \"-\"\n      }\n    </div>\n    <div className=\"label\">\n      Mindestens Level\n    </div>\n    <div className=\"value\">\n      {\n        permission === \"edit\"\n        ?\n        (<input type=\"number\" value={values.minLevel} onChange={(evt) => setValues({ ...values, minLevel: parseInt(evt.target.value, 10) })} />)\n        :\n        quest.minLevel\n      }\n    </div>\n    <div className=\"label\">\n      Maximale XP\n    </div>\n    <div className=\"value\">\n      {\n        permission === \"edit\"\n        ?\n        (<input type=\"number\" value={values.maxXp} onChange={(evt) => setValues({ ...values, maxXp: parseInt(evt.target.value, 10) })} />)\n        :\n        quest.maxXp\n      }\n    </div>\n    <div className=\"label\">\n      Erreichte XP\n    </div>\n    <div className=\"value\">\n      {\n        permission === \"edit\"\n        ?\n        (\n          <>\n            <input type=\"number\" value={values.xp ?? \"-\"} onChange={(evt) => {\n              const xp = parseInt(evt.target.value, 10);\n              setValues({ ...values, xp })\n            }} />\n            <Button onClick={() => setValues({ ...values, xp: null })}><AiFillDelete /></Button>\n          </>\n        )\n        :\n        quest.state !== \"closed\" ? \"-\" : quest.xp\n      }\n    </div>\n    {\n      permission === \"edit\" && (\n        <>\n          <div className=\"label\">\n            Versteckt\n          </div>\n          <div className=\"value\">\n            <input type=\"checkbox\" checked={values.disabled} onChange={(evt) => setValues({ ...values, disabled: evt.target.checked })} />\n          </div>\n          <div className=\"label\">\n            Archiviert\n          </div>\n          <div className=\"value\">\n            <input type=\"checkbox\" checked={values.archived} onChange={(evt) => setValues({ ...values, archived: evt.target.checked })} />\n          </div>\n        <div className=\"buttonContainer\">\n          <Button loading={loading} onClick={onSave}>\n            Speichern\n          </Button>\n          {quest.archived && (\n            <div className=\"deleteContainer\">\n              <button onClick={onDelete}>Quest lÃ¶schen</button>\n            </div>\n          )}\n          {loading ?? <>loading...</>}\n          {error && <>{JSON.stringify(error)}</>}\n        </div>\n        <h4>Versionen</h4>\n        <div className=\"versionList\">\n          {quest.versions?.map(({ id, created_at, fields }) => (\n            <div className=\"versionItem\">\n              Version {id} vom {new Intl.DateTimeFormat(\"de\").format(new Date(created_at))} {created_at.substring(11, 19)}{\" \"}\n              <button onClick={() => setValues({ ...values, ...fields, maxXp: fields.max_xp, minLevel: fields.min_level })}>ðŸ”ƒ</button>\n            </div>\n          ))}\n        </div>\n      </>\n    )}\n  </div>;\n}","import React, { useCallback, useEffect, useState } from \"react\";\nimport { Level } from \"../../api/useData\";\nimport { usePostLevels } from \"../../api/usePostLevels\";\nimport Button from \"../../components/Button\";\nimport \"./styles.scss\";\n\nexport default function Levels(props: { levels: Level[] }): JSX.Element {\n  const [values, setValues] = useState<number[]>([]);\n\n  useEffect(() => {\n    setValues(props.levels.sort((a, b) => a.id - b.id).map(({ requiredXp }) => requiredXp));\n  }, [props.levels]);\n\n  const deleteElement = useCallback((i: number) => {\n    if (i < 0 || i >= values.length) return;\n    setValues(values.filter((value, index) => index !== i));\n  }, [values, setValues]);\n\n  const changeElement = useCallback((i: number, valueNew: number) => {\n    if (i < 0 || i >= values.length || valueNew < 0) return;\n    const valueBefore = values[i - 1];\n    if (valueBefore != null && valueBefore >= valueNew) return;\n    const valueCurrent = values[i];\n    const diff = valueNew - valueCurrent;\n    setValues(values.map((value, index) => i <= index ? value + diff : value));\n  }, [values, setValues]);\n\n  const { loading, error, post } = usePostLevels();\n\n  return (\n    <div className=\"levels-page\">\n      <h2>Levels</h2>\n      {values.map((requiredXp, index) => (\n        <div className=\"level-container\" key={index}>\n          <div className=\"level-index\">{index + 1}</div>\n          <div className=\"level-xp\">\n            <input type=\"number\" value={requiredXp} onChange={(evt) => changeElement(index, parseInt(evt.target.value, 10))} />\n          </div>\n          <div className=\"level-delete\">\n            <button onClick={() => deleteElement(index)}>LÃ¶schen</button>\n          </div>\n        </div>\n      ))}\n      <div className=\"level-button-container\">\n        <Button onClick={() => setValues([...values, values[values.length - 1] + 1])} loading={loading}>Neues Level</Button>\n        <Button onClick={() => post(values.map((value, index) => ({ id: index + 1, requiredXp: value })))} loading={loading}>Speichern</Button>\n      </div>\n      {loading && <>loading...</>}\n      {error && <>Error: {JSON.stringify(error)}</>}\n    </div>\n  );\n}","import { useCallback, useState } from \"react\";\nimport { Level } from \"./useData\";\n\nexport function usePostLevels() {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<any | null>(null);\n\n  const post = useCallback(async (levels: Level[]) => {\n    try {\n      setLoading(true);\n      await fetch(`${window.location.hostname === \"localhost\" ? \"http://localhost:3000\" : \"\"}/api/levels`, {\n        method: \"POST\",\n        mode: \"no-cors\",\n        cache: 'no-cache',\n        credentials: \"same-origin\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        referrerPolicy: 'no-referrer',\n        body: JSON.stringify(levels)\n      })\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [setError, setLoading]);\n\n  return { loading, error, post };\n}\n","import React, { useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport Loading from \"../../components/Loading\";\nimport NoData from \"../../components/NoData\";\nimport { useGetRewardsQuery, useCreateRewardMutation } from \"../../model/services/rewards\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport \"./styles.scss\";\n\nexport default function Rewards(props: { refetch: () => void }): JSX.Element {\n  const permission = useSelector(selectPermission);\n  const { data, error, isLoading, refetch } = useGetRewardsQuery(undefined);\n  const [createReward] = useCreateRewardMutation();\n\n  useEffect(() => refetch(), [refetch]);\n\n  const history = useHistory();\n\n  return (\n    <div className=\"rewards\">\n      <h2>Belohnungen</h2>\n      {isLoading && <Loading />}\n      {error && <span className=\"error\">{JSON.stringify(error)}</span>}\n      {\n        data != null && data.length > 0 ? (\n          <ul className=\"rewards-list\">\n            {\n              data?.filter((item) => !item.disabled || permission === \"edit\")\n                .map((item, index) => (\n                <li\n                  key={index} className={`reward-item ${item.disabled === true ? \"disabled\" : \"enabled\"} ${item.locked === true ? \"locked\" : \"unlocked\"}`}\n                  onClick={() => {\n                    if (item.locked && permission === \"none\") return;\n                    history.push(`/rewards/${item.id}`);\n                  }}\n                >\n                  <div className=\"title\">\n                    {item.locked && permission === \"none\" ? \"ðŸ”’ ???\" : item.title}{permission === \"edit\" && <> ({item.id})</>}\n                  </div>\n                  <div className=\"description\">\n                    {item.locked && permission === \"none\" ? \"\" : item.description}\n                  </div>\n                  <div className=\"min-level\">\n                    Ab Level {item.minLevel}\n                  </div>\n                </li>\n              ))\n            }\n          </ul>\n        ) : (\n          <NoData />\n        )\n      }\n      {permission === \"edit\" && (\n        <div className=\"createQuestContainer\">\n          <button onClick={async () => {\n            createReward(undefined);\n          }}>\n            + Neue Belohnung\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { AiFillEdit } from \"react-icons/ai\";\nimport { BiArrowBack } from \"react-icons/bi\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { Button, Error, Loading, NoData } from \"../../components\";\nimport { useAppSelector } from \"../../model/hooks\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport { useGetRewardQuery } from \"../../model/services/rewards\";\nimport \"./styles.scss\";\n\nexport default function RewardDetails(props: object): JSX.Element {\n  const { id } = useParams<{ id: string }>();\n  const history = useHistory();\n  const { data: reward, error, isLoading, refetch } = useGetRewardQuery(id);\n  const permission = useAppSelector(selectPermission);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  if (isLoading) return <Loading />;\n  if (reward == null) return <NoData />;\n  if (error) return <Error error={error} />\n\n  return <div className=\"reward-detail\">\n    <div className=\"reward-header\" >\n      <BiArrowBack className=\"back-arrow\" onClick={() => history.push(\"/rewards\")} />\n      <div className=\"reward-title\">{reward.title ?? \"-\"}</div>\n    </div>\n    {reward.img && <img className=\"reward-image\" src={`${reward.img}`} alt={reward.img} />}\n    <div className=\"reward-description\">{reward.description?.split(/\\n/).map((part) => (<p>{part}</p>)) ?? \"-\"}</div>\n    {\n      permission === \"edit\" && (\n        <Button onClick={() => history.push(`/rewards/${reward.id}/edit`)} >\n          <AiFillEdit />\n        </Button>\n      )\n    }\n  </div>;\n}","import React, { useCallback, useEffect, useState } from \"react\";\nimport { BiArrowBack } from \"react-icons/bi\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { Button, Error, Loading, NoData } from \"../../components\";\nimport { useAppSelector } from \"../../model/hooks\";\nimport { selectPermission } from \"../../model/permissionReducer\";\nimport { Reward, useGetRewardQuery, useUpdateRewardMutation } from \"../../model/services/rewards\";\nimport \"./styles.scss\";\n\nexport default function RewardEdit(props: object): JSX.Element {\n  const { id } = useParams<{ id: string }>();\n  const history = useHistory();\n  const { data: reward, error, isLoading, refetch } = useGetRewardQuery(id); \n  const [updateReward, { isLoading: isUpdating }] = useUpdateRewardMutation();\n  const permission = useAppSelector(selectPermission);\n  const [values, setValues] = useState<Partial<Reward>>(reward ?? {});\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  useEffect(() => {\n    const data = reward ?? {};\n    setValues(data);\n  }, [setValues, reward]);\n\n  const onSave = useCallback(() => {\n    if (reward == null) return;\n    updateReward({ ...values, id: reward.id });\n    refetch();\n    history.push(`/rewards/${reward.id}`);\n  }, [updateReward, history, refetch, reward, values]);\n\n  if (isLoading) return <Loading />;\n  if (reward == null) return <NoData />;\n  if (error) return <Error error={error} />\n  if (permission !== \"edit\") return <>Keine Berechtigung</>;\n\n  return <div className=\"reward-edit\">\n    <div className=\"reward-header\" >\n      <BiArrowBack className=\"back-arrow\" onClick={() => history.push(\"/rewards\")} />\n      <div className=\"reward-title\">\n        <input value={values.title} onChange={(evt) => setValues({ ...values, title: evt.target.value })} />\n      </div>\n    </div>\n    Image: <input value={values.img} onChange={(evt) => setValues({ ...values, img: evt.target.value })} />\n    <div className=\"reward-description\">\n      <textarea rows={10} value={values.description} onChange={(evt) => setValues({ ...values, description: evt.target.value })} />\n    </div>\n    Min-Level: <input type=\"number\" value={values.minLevel} onChange={(evt) => setValues({ ...values, minLevel: parseInt(evt.target.value, 10) })} />\n    Versteckt: <input type=\"checkbox\" checked={values.disabled} onChange={(evt) => setValues({ ...values, disabled: evt.target.checked })} />\n    <Button onClick={onSave} loading={isUpdating} >\n      Speichern\n    </Button>\n  </div>;\n}","import React from \"react\";\nimport { useState } from \"react\";\nimport { MdSend } from \"react-icons/md\";\nimport Button from \"../../components/Button\";\nimport { useAppSelector, useAppDispatch } from \"../../model/hooks\";\nimport { selectToken, selectPermission, changeToken } from \"../../model/permissionReducer\";\nimport { PushPayload } from \"../../push-notification/usePushNotifications\";\nimport \"./styles.scss\";\n\nexport default function Settings(props: {\n  userConsent: \"default\" | \"denied\" | \"granted\";\n  onClickAskUserPermission: () => Promise<void>;\n  onClickSusbribeToPushNotification: () => Promise<void>;\n  onClickSendNotification: (payload: PushPayload) => Promise<void>;\n  loading: boolean;\n  error: any;\n}): JSX.Element {\n  const token = useAppSelector(selectToken);\n  const permission = useAppSelector(selectPermission);\n  const dispatch = useAppDispatch();\n  const [title, setTitle] = useState(\"\");\n  const [text, setText] = useState(\"\");\n  const [url, setUrl] = useState(\"/quests\");\n\n  return (\n    <div className=\"settings\">\n      <h2>Einstellungen</h2>\n      <div className=\"push\">\n        <h3>Push-Benachrichtigungen</h3>\n        <input className=\"push-permission\" type=\"checkbox\" checked={props.userConsent === \"granted\"} onChange={async () => {\n          await props.onClickAskUserPermission();\n          await props.onClickSusbribeToPushNotification();\n        }} />Benachrichtigungen erlauben\n        <Error error={props.error} />\n        {\n          permission === \"edit\" && (\n            <div className=\"push-form\">\n              <h4 className=\"form-title\">Benutzerdefinierte Benachrichtigung</h4>\n              <div className=\"label\">Titel</div>\n              <div className=\"value\">\n                <input value={title} onChange={(evt) => setTitle(evt.target.value ?? \"\")} />\n              </div>\n              <div className=\"label\">Text</div>\n              <div className=\"value\">\n                <input value={text} onChange={(evt) => setText(evt.target.value ?? \"\")} />\n              </div>\n              <div className=\"label\">Url</div>\n              <div className=\"value\">\n                <input value={url} onChange={(evt) => setUrl(evt.target.value ?? \"\")} />\n              </div>\n              <div className=\"submit\">\n                <Button onClick={() => props.onClickSendNotification({ title, text, url })} loading={props.loading}>\n                  <>Senden <MdSend /></>\n                </Button>\n              </div>\n            </div>\n          )\n        }\n      </div>\n      <div className=\"permission\">\n        <h3>Berechtigung</h3>\n        <span>Rolle: {permission}</span>\n        <div className=\"token\">\n          Token: <input value={token} onChange={(evt) => dispatch(changeToken(evt.target.value))} />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nconst Error = ({ error }: { error: any }) =>\n  error ? (\n    <section className=\"app-error\">\n      <h2>{error.name}</h2>\n      <p>Error message : {error.message}</p>\n      <p>Error code : {error.code}</p>\n    </section>\n  ) : null;\n","import React, { useEffect } from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport { useData } from \"../../api/useData\";\nimport GameHeader from \"./GameHeader\";\nimport GameFooter from \"./GameFooter\";\nimport usePushNotifications from \"../../push-notification/usePushNotifications\";\nimport Quests from \"../Quests\";\nimport QuestDetail from \"../QuestDetail\";\nimport Levels from \"../Levels\";\nimport Rewards from \"../Rewards\";\nimport RewardDetail from \"../RewardDetail\";\nimport RewardEdit from \"../RewardEdit\";\nimport Settings from \"../Settings\";\nimport \"./styles.scss\";\n\nexport default function Game(props: object): JSX.Element {\n  const { data, error, loading, refetch } = useData();\n  const {\n    userConsent,\n    userSubscription,\n    onClickAskUserPermission,\n    onClickSusbribeToPushNotification,\n    onClickSendSubscriptionToPushServer,\n    onClickSendNotification,\n    loading: pushLoading,\n    error: pushError\n  } = usePushNotifications();\n\n  useEffect(() => {\n    console.log(\"update push subscription\");\n    if (userConsent === \"granted\" && userSubscription != null) onClickSendSubscriptionToPushServer();\n  }, [userConsent, userSubscription, onClickSendSubscriptionToPushServer]);\n\n  return (\n    <div className=\"game\">\n      <GameHeader data={data} />\n      <div className=\"game-main\">\n        {loading && <>Laden ...</>}\n        {error && <>{typeof error === \"string\" ? error : JSON.stringify(error)}</>}\n        {data && (\n            <>\n              <Switch>\n                <Route path=\"/levels\" exact>\n                  <Levels levels={data.levels} />\n                </Route>\n                <Route path=\"/quests\" exact>\n                  <Quests quests={data.quests} refetch={refetch} />\n                </Route>\n                <Route path=\"/quests/:id\" exact>\n                  <QuestDetail />\n                </Route>\n                <Route path=\"/rewards\" exact>\n                  <Rewards refetch={refetch} />\n                </Route>\n                <Route path=\"/rewards/:id\" exact>\n                  <RewardDetail />\n                </Route>\n                <Route path=\"/rewards/:id/edit\" exact>\n                  <RewardEdit />\n                </Route>\n                <Route path=\"/settings\">\n                  <Settings\n                    userConsent={userConsent}\n                    onClickAskUserPermission={onClickAskUserPermission}\n                    onClickSusbribeToPushNotification={onClickSusbribeToPushNotification}\n                    onClickSendNotification={onClickSendNotification}\n                    loading={pushLoading}\n                    error={pushError}\n                  />\n                </Route>\n              </Switch>\n            </>\n          )\n        }\n      </div>\n      <Route path=\"/\" component={GameFooter} />\n    </div>\n  );\n}\n","import Cookies from \"js-cookie\";\nimport React, { useEffect } from \"react\";\nimport Game from \"./pages/Game\";\nimport { useAppDispatch } from \"./model/hooks\";\nimport { changeToken } from \"./model/permissionReducer\";\nimport \"./App.scss\";\n\nexport default function App() {\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    const token = getPermissionTokenFromUrlOrCookie();\n    if (token != null) dispatch(changeToken(token));\n  }, [dispatch]);\n\n  return (\n    <div className=\"app\" onTouchMove={(evt) => console.log(evt)}>\n      <Game />\n    </div>\n  );\n}\n\nfunction getPermissionTokenFromUrlOrCookie(): string | undefined {\n  try {\n    const params = new URLSearchParams(window.location.search);\n    const token = params.get(\"token\") ?? Cookies.get(\"token\");\n    return token ?? undefined;\n  } catch (err) {\n    console.warn(\"Error loading the permission token from url or cookie: \", JSON.stringify(err));\n    return undefined;\n  }\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport { Provider } from \"react-redux\";\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Redirect, Route } from 'react-router-dom';\nimport { store } from \"./model/store\";\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <BrowserRouter>\n        <Route path=\"/\" exact component={() => <Redirect to=\"/quests\" />} />\n        <App />\n      </BrowserRouter>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}