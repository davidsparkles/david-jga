(this["webpackJsonpdavid-jga-frontend"]=this["webpackJsonpdavid-jga-frontend"]||[]).push([[0],{48:function(e,t,n){},50:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(10),s=n(25),i=n.n(s),o=n(20),l=n(8),u=n(26),d=n(3),j=n(17),b=n.n(j),h=Object(d.d)({name:"permission",initialState:{token:"",permission:"none"},reducers:{changeToken:function(e,t){var n=t.payload;switch(e.token=n,b.a.get("token")!==n&&b.a.set("token",n,{sameSite:"lax",expires:30}),n){case"broiler":e.permission="edit";break;case"fittie":e.permission="view";break;default:e.permission="none"}}}}),v=h.actions.changeToken,O=function(e){return e.permission.token},p=function(e){return e.permission.permission},f=h.reducer,x=n(13),m=n(30),g=Object(m.a)({reducerPath:"rewardsApi",baseQuery:Object(x.d)({baseUrl:"/api/"}),endpoints:function(e){return{getRewards:e.query({query:function(){return"rewards"}})}}}),k=g.useGetRewardsQuery,N=Object(d.a)({reducer:Object(u.a)({permission:f},g.reducerPath,g.reducer),middleware:function(e){return e().concat(g.middleware)}});Object(x.e)(N.dispatch);var C=n(4),S=n.n(C),w=n(5),y=n(9);function L(e){return T.apply(this,arguments)}function T(){return(T=Object(y.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(null!==t&&void 0!==t?t:"/api/data");case 2:if(200!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",n.json());case 5:throw console.error("Fetch error: ".concat(n.status," ").concat(n.statusText," ").concat(n.text())),new Error(n.statusText);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(48);var P=n(2);function q(e){var t,n,c,r,a,s,i,o,l,u;return Object(P.jsxs)("div",{className:"gameHeader",children:[Object(P.jsx)("div",{className:"gameHeaderTitle",children:"Quest Master"}),Object(P.jsxs)("div",{className:"gameHeaderLevel",children:["Level ",null!==(t=null===(n=e.data)||void 0===n?void 0:n.currentLevel)&&void 0!==t?t:1," / ",null!==(c=null===(r=e.data)||void 0===r?void 0:r.maxLevel)&&void 0!==c?c:"?"]}),Object(P.jsx)(F,{current:null!==(a=null===(s=e.data)||void 0===s?void 0:s.xpWithinCurrentLevel)&&void 0!==a?a:0,max:(null!==(i=null===(o=e.data)||void 0===o?void 0:o.xpToNextLevel)&&void 0!==i?i:0)+(null!==(l=null===(u=e.data)||void 0===u?void 0:u.xpWithinCurrentLevel)&&void 0!==l?l:1)})]})}function F(e){var t=100*e.current/e.max;return Object(P.jsxs)("div",{className:"gameProgressContainer",children:[Object(P.jsx)("div",{className:"gameProgressBar",children:Object(P.jsx)("div",{style:{width:"".concat(t,"%")},className:"gameProgressCurrent",children:Object(P.jsx)("div",{className:"gameProgressCurrentText",children:e.current})})}),e.max,"\u2191"]})}var E=n(33),A=n(34),B=n(35),X=function(){return Object(a.d)()},J=a.e;n(50);function Q(e){var t=J(p);return Object(P.jsxs)("div",{className:"gameFooter",style:"edit"===t?{gridTemplateColumns:"auto auto auto auto"}:void 0,children:[Object(P.jsx)(o.b,{to:{pathname:"/quests",search:e.location.search},children:Object(P.jsx)(A.a,{})}),Object(P.jsx)(o.b,{to:{pathname:"/rewards",search:e.location.search},children:Object(P.jsx)(E.b,{})}),"edit"===t&&Object(P.jsx)(o.b,{to:{pathname:"/levels",search:e.location.search},children:Object(P.jsx)(B.a,{})}),Object(P.jsx)(o.b,{to:{pathname:"/settings",search:e.location.search},children:Object(P.jsx)(E.a,{})})]})}var D={post:function(e,t){return fetch(e,{credentials:"omit",headers:{"content-type":"application/json;charset=UTF-8","sec-fetch-mode":"cors"},body:JSON.stringify(t),method:"POST",mode:"cors"}).then((function(e){return e.json()})).then((function(e){return e}))},get:function(e){return fetch(e,{credentials:"omit",headers:{"content-type":"application/json;charset=UTF-8","sec-fetch-mode":"cors"},method:"GET",mode:"cors"}).then((function(e){return e.json()})).then((function(e){return e}))}},M="BDTxsv_QJLLjMkKfKrZw9kLADmciH2_E1B4Smkp9kbOLHWlrNs_3jFZA3zCyYbw9GRKq5hoEhkcHiBMf8OiGKDQ";function U(){return(U=Object(y.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Notification.requestPermission();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(y.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.serviceWorker.ready;case 2:return t=e.sent,e.next=5,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:M});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H="serviceWorker"in navigator&&"PushManager"in window;function W(){var e=Object(c.useState)(Notification.permission),t=Object(w.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),s=Object(w.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)(),u=Object(w.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(null),h=Object(w.a)(b,2),v=h[0],O=h[1],p=Object(c.useState)(!0),f=Object(w.a)(p,2),x=f[0],m=f[1];return Object(c.useEffect)((function(){H&&(m(!0),O(!1),navigator.serviceWorker.register("/sw.js").then((function(){m(!1)})))}),[]),Object(c.useEffect)((function(){m(!0),O(!1),function(){var e=Object(y.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.serviceWorker.ready.then((function(e){return e.pushManager.getSubscription()})).then((function(e){return e}));case 2:t=e.sent,o(t),m(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),{onClickAskUserPermission:Object(c.useCallback)((function(){return m(!0),O(!1),function(){return U.apply(this,arguments)}().then((function(e){r(e),"granted"!==e&&O({name:"Consent denied",message:"You denied the consent to receive notifications",code:0}),m(!1)}))}),[m,O,r]),onClickSusbribeToPushNotification:Object(c.useCallback)((function(){return m(!0),O(!1),function(){return I.apply(this,arguments)}().then((function(e){o(e),m(!1)})).catch((function(e){console.error("Couldn't create the notification subscription",e,"name:",e.name,"message:",e.message,"code:",e.code),O(e),m(!1)}))}),[m,O,o]),onClickSendSubscriptionToPushServer:Object(c.useCallback)((function(){null!=i&&"granted"===n?(m(!0),O(!1),D.post("/api/subscription",i).then((function(e){j(e.id),m(!1)})).catch((function(e){m(!1),O(e)}))):console.log("No userSubscription present or consent not given")}),[i,n,m,O,j]),pushServerSubscriptionId:d,onClickSendNotification:Object(c.useCallback)(function(){var e=Object(y.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),O(!1),e.next=4,D.post("/api/custom-subscription",t).catch((function(e){m(!1),O(e)}));case 4:m(!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,O]),userConsent:n,pushNotificationSupported:H,userSubscription:i,error:v,loading:x}}function K(){var e=Object(c.useState)(!1),t=Object(w.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),s=Object(w.a)(a,2),i=s[0],o=s[1];return{loading:n,error:i,post:Object(c.useCallback)(function(){var e=Object(y.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,fetch("".concat("localhost"===window.location.hostname?"http://localhost:3000":"","/api/quest"),{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o(e.t0);case 9:return e.prev=9,r(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[o,r])}}var _=n(11),R=n(36);function G(e){var t,n,r,a,s=e.quest,i=e.onBack,o=J(p),l=Object(c.useState)({title:"",description:"",maxXp:0,minLevel:0,xp:null,disabled:!1,archived:!1}),u=Object(w.a)(l,2),d=u[0],j=u[1],b=K(),h=b.loading,v=b.error,O=b.post;Object(c.useEffect)((function(){var e,t,n,c;null!=s&&j({title:null!==(e=s.title)&&void 0!==e?e:"",description:null!==(t=s.description)&&void 0!==t?t:"",maxXp:s.maxXp,minLevel:s.minLevel,xp:s.xp,disabled:null!==(n=s.disabled)&&void 0!==n&&n,archived:null!==(c=s.archived)&&void 0!==c&&c})}),[s]);var f=Object(c.useCallback)(Object(y.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(Object(_.a)({id:s.id},d));case 2:i();case 3:case"end":return e.stop()}}),e)}))),[i,O,s,d]),x=Object(c.useCallback)(Object(y.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({delete:!0,id:s.id});case 2:i();case 3:case"end":return e.stop()}}),e)}))),[i,O,s]);return Object(P.jsxs)("div",{className:"questDetails",children:[Object(P.jsxs)("div",{className:"backArrowContainer",children:[Object(P.jsx)(R.a,{className:"backArrow",onClick:function(){return i()}}),Object(P.jsx)("div",{className:"value",children:"edit"===o?Object(P.jsx)("input",{value:d.title,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{title:e.target.value}))}}):null!==(t=s.title)&&void 0!==t?t:"-"})]}),Object(P.jsx)("div",{className:"label",children:"Beschreibung"}),Object(P.jsx)("div",{className:"value",children:"edit"===o?Object(P.jsx)("textarea",{rows:10,value:d.description,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{description:e.target.value}))}}):null!==(n=s.description)&&void 0!==n?n:"-"}),Object(P.jsx)("div",{className:"label",children:"Mindestens Level"}),Object(P.jsx)("div",{className:"value",children:"edit"===o?Object(P.jsx)("input",{type:"number",value:d.minLevel,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{minLevel:parseInt(e.target.value,10)}))}}):s.minLevel}),Object(P.jsx)("div",{className:"label",children:"Maximale XP"}),Object(P.jsx)("div",{className:"value",children:"edit"===o?Object(P.jsx)("input",{type:"number",value:d.maxXp,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{maxXp:parseInt(e.target.value,10)}))}}):s.maxXp}),Object(P.jsx)("div",{className:"label",children:"Erreichte XP"}),Object(P.jsx)("div",{className:"value",children:"edit"===o?Object(P.jsx)("input",{type:"number",value:null!==(r=d.xp)&&void 0!==r?r:"-",onChange:function(e){var t=parseInt(e.target.value,10);j(Object(_.a)(Object(_.a)({},d),{},{xp:t<0?null:t}))}}):"closed"!==s.state?"-":s.xp}),"edit"===o&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"label",children:"Versteckt"}),Object(P.jsx)("div",{className:"value",children:Object(P.jsx)("input",{type:"checkbox",checked:d.disabled,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{disabled:e.target.checked}))}})}),Object(P.jsx)("div",{className:"label",children:"Archiviert"}),Object(P.jsx)("div",{className:"value",children:Object(P.jsx)("input",{type:"checkbox",checked:d.archived,onChange:function(e){return j(Object(_.a)(Object(_.a)({},d),{},{archived:e.target.checked}))}})}),Object(P.jsxs)("div",{className:"buttonContainer",children:[Object(P.jsx)("div",{className:"saveContainer",children:Object(P.jsx)("button",{onClick:f,children:"Speichern"})}),s.archived&&Object(P.jsx)("div",{className:"deleteContainer",children:Object(P.jsx)("button",{onClick:x,children:"Quest l\xf6schen"})}),null!==h&&void 0!==h?h:Object(P.jsx)(P.Fragment,{children:"loading..."}),v&&Object(P.jsx)(P.Fragment,{children:JSON.stringify(v)})]}),Object(P.jsx)("h4",{children:"Versionen"}),Object(P.jsx)("div",{className:"versionList",children:null===(a=s.versions)||void 0===a?void 0:a.map((function(e){var t=e.id,n=e.created_at,c=e.fields;return Object(P.jsxs)("div",{className:"versionItem",children:["Version ",t," vom ",new Intl.DateTimeFormat("de").format(new Date(n))," ",n.substring(11,19)," ",Object(P.jsx)("button",{onClick:function(){return j(Object(_.a)(Object(_.a)(Object(_.a)({},d),c),{},{maxXp:c.max_xp,minLevel:c.min_level}))},children:"\ud83d\udd03"})]})}))})]})]})}n(53);function V(e){var t=J(p),n=Object(c.useState)(null==b.a.get("filterList")||"true"===b.a.get("filterList")),r=Object(w.a)(n,2),a=r[0],s=r[1],i=Object(c.useState)(null!=b.a.get("filterArchivedList")&&"true"===b.a.get("filterArchivedList")),o=Object(w.a)(i,2),l=o[0],u=o[1],d=Object(c.useState)(null),j=Object(w.a)(d,2),h=j[0],v=j[1],O=K(),f=O.loading,x=O.error,m=O.post;return null!=h?Object(P.jsx)(G,{quest:h,onBack:function(){v(null),e.refetch()}}):Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:"questList",children:[Object(P.jsxs)("div",{className:"questFilter",children:[Object(P.jsx)("input",{type:"checkbox",checked:a,onChange:function(e){s(e.target.checked),b.a.set("filterList","".concat(e.target.checked))}}),"Erledigte Quests"]}),"edit"===t&&Object(P.jsxs)("div",{className:"questFilter",children:[Object(P.jsx)("input",{type:"checkbox",checked:l,onChange:function(e){u(e.target.checked),b.a.set("filterArchivedList","".concat(e.target.checked))}}),"Archivierte Quests"]}),e.quests.filter((function(e){var t=e.state;return!0===a||"closed"!==t})).filter((function(e){var t=e.archived;return!0===l||!1===t})).filter((function(e){var n=e.archived,c=e.disabled;return!1===n&&!1===c||"edit"===t})).map((function(e,n){var c;return Object(P.jsxs)("div",{className:"questBox ".concat(e.state," ").concat(e.disabled?"disabled":""," ").concat(e.archived?"archived":""),onClick:function(){return!("none"===t&&"hidden"===e.state)&&v(e)},children:[Object(P.jsxs)("div",{className:"questHeader",children:[Object(P.jsx)("div",{className:"questTitle",children:"none"===t&&"hidden"===e.state||null==e.title?"\ud83d\udd12 ???":"".concat("hidden"===e.state?"\ud83d\udd12 ":"").concat(e.title)}),Object(P.jsxs)("div",{className:"questPoints",children:["closed"!==e.state?e.maxXp:"".concat(e.xp," / ").concat(e.maxXp)," XP"]})]}),!("none"===t&&"hidden"===e.state)&&Object(P.jsx)("div",{className:"questDescription",children:z(null!==(c=e.description)&&void 0!==c?c:"???")}),"hidden"===e.state&&Object(P.jsxs)("div",{className:"questDescription",children:["Ab Level ",e.minLevel]})]},n)}))]}),"edit"===t&&Object(P.jsx)("div",{className:"createQuestContainer",children:Object(P.jsx)("button",{onClick:Object(y.a)(S.a.mark((function t(){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m({title:"Neue Quest",description:"",maxXp:1,disabled:!0,minLevel:20,archived:!1});case 2:e.refetch();case 3:case"end":return t.stop()}}),t)}))),children:"+ Neue Quest"})}),f&&"loading ...",x&&Object(P.jsxs)(P.Fragment,{children:["Fehler: ",JSON.stringify(x)]})]})}function z(e){return null==e?"???":e.length<100?e:e.substring(0,96)+" ..."}var Y=n(38);n(54);function Z(e){var t=Object(c.useState)([]),n=Object(w.a)(t,2),r=n[0],a=n[1];Object(c.useEffect)((function(){a(e.levels.sort((function(e,t){return e.id-t.id})).map((function(e){return e.requiredXp})))}),[e.levels]);var s=Object(c.useCallback)((function(e){e<0||e>=r.length||a(r.filter((function(t,n){return n!==e})))}),[r,a]),i=Object(c.useCallback)((function(e,t){if(!(e<0||e>=r.length||t<0)){var n=r[e-1];if(!(null!=n&&n>=t)){var c=t-r[e];a(r.map((function(t,n){return e<=n?t+c:t})))}}}),[r,a]),o=function(){var e=Object(c.useState)(!1),t=Object(w.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),s=Object(w.a)(a,2),i=s[0],o=s[1];return{loading:n,error:i,post:Object(c.useCallback)(function(){var e=Object(y.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,fetch("".concat("localhost"===window.location.hostname?"http://localhost:3000":"","/api/levels"),{method:"POST",mode:"no-cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o(e.t0);case 9:return e.prev=9,r(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(t){return e.apply(this,arguments)}}(),[o,r])}}(),l=o.loading,u=o.error,d=o.post;return Object(P.jsxs)("div",{className:"levels-page",children:[Object(P.jsx)("h2",{children:"Levels"}),r.map((function(e,t){return Object(P.jsxs)("div",{className:"level-container",children:[Object(P.jsx)("div",{className:"level-index",children:t+1}),Object(P.jsx)("div",{className:"level-xp",children:Object(P.jsx)("input",{type:"number",value:e,onChange:function(e){return i(t,parseInt(e.target.value,10))}})}),Object(P.jsx)("div",{className:"level-delete",children:Object(P.jsx)("button",{onClick:function(){return s(t)},children:"L\xf6schen"})})]},t)})),Object(P.jsx)("button",{className:"level-add",onClick:function(){return a([].concat(Object(Y.a)(r),[r[r.length-1]+1]))},children:"Neues Level"}),Object(P.jsx)("br",{}),Object(P.jsx)("button",{className:"levels-save",onClick:function(){return d(r.map((function(e,t){return{id:t+1,requiredXp:e}})))},children:"Speichern"}),l&&Object(P.jsx)(P.Fragment,{children:"loading..."}),u&&Object(P.jsxs)(P.Fragment,{children:["Error: ",JSON.stringify(u)]})]})}n(55);function $(e){var t=Object(c.useState)(""),n=Object(w.a)(t,2),r=n[0],a=n[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){a(r.length>=3?"":r+".")}),1e3);return function(){return clearTimeout(e)}}),[r,a]),Object(P.jsxs)("div",{className:"loading-component",children:["Laden ",r]})}n(56);function ee(e){var t;return Object(P.jsx)("div",{className:"no-data",children:null!==(t=e.text)&&void 0!==t?t:"Keine Daten gefunden"})}n(57);function te(e){var t=Object(a.e)(p),n=k(void 0),c=n.data,r=n.error,s=n.isLoading;return Object(P.jsxs)("div",{className:"rewards",children:[Object(P.jsx)("h2",{children:"Belohnungen"}),s&&Object(P.jsx)($,{}),r&&Object(P.jsx)("span",{className:"error",children:JSON.stringify(r)}),null!=c&&c.length>0?Object(P.jsx)("ul",{className:"rewards-list",children:null===c||void 0===c?void 0:c.map((function(e,n){return Object(P.jsxs)("li",{className:"reward-item ".concat(!0===e.disabled?"disabled":"enabled"," ").concat(!0===e.locked?"locked":"unlocked"),children:[Object(P.jsxs)("div",{className:"title",children:[e.title,"edit"===t&&Object(P.jsxs)(P.Fragment,{children:[" (",e.id,")"]})]}),Object(P.jsx)("div",{className:"description",children:e.description}),Object(P.jsxs)("div",{className:"min-level",children:["Ab Level ",e.minLevel]})]},n)}))}):Object(P.jsx)(ee,{})]})}var ne=n(37);n(58);function ce(e){var t=J(O),n=J(p),r=X(),a=Object(c.useState)(""),s=Object(w.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)(""),u=Object(w.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)("/quests"),h=Object(w.a)(b,2),f=h[0],x=h[1];return Object(P.jsxs)("div",{className:"settings",children:[Object(P.jsx)("h2",{children:"Einstellungen"}),Object(P.jsxs)("div",{className:"push",children:[Object(P.jsx)("h3",{children:"Push-Benachrichtigungen"}),Object(P.jsx)("input",{className:"push-permission",type:"checkbox",checked:"granted"===e.userConsent,onChange:Object(y.a)(S.a.mark((function t(){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onClickAskUserPermission();case 2:return t.next=4,e.onClickSusbribeToPushNotification();case 4:case"end":return t.stop()}}),t)})))}),"Benachrichtigungen erlauben",Object(P.jsx)(re,{loading:e.loading}),Object(P.jsx)(ae,{error:e.error}),"edit"===n&&Object(P.jsxs)("div",{className:"push-form",children:[Object(P.jsx)("h4",{className:"form-title",children:"Benutzerdefinierte Benachrichtigung"}),Object(P.jsx)("div",{className:"label",children:"Titel"}),Object(P.jsx)("div",{className:"value",children:Object(P.jsx)("input",{value:i,onChange:function(e){var t;return o(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(P.jsx)("div",{className:"label",children:"Text"}),Object(P.jsx)("div",{className:"value",children:Object(P.jsx)("input",{value:d,onChange:function(e){var t;return j(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(P.jsx)("div",{className:"label",children:"Url"}),Object(P.jsx)("div",{className:"value",children:Object(P.jsx)("input",{value:f,onChange:function(e){var t;return x(null!==(t=e.target.value)&&void 0!==t?t:"")}})}),Object(P.jsx)("div",{className:"submit",children:Object(P.jsxs)("button",{onClick:function(){return e.onClickSendNotification({title:i,text:d,url:f})},children:["Senden ",Object(P.jsx)(ne.a,{})]})})]})]}),Object(P.jsxs)("div",{className:"permission",children:[Object(P.jsx)("h3",{children:"Berechtigung"}),Object(P.jsxs)("span",{children:["Rolle: ",n]}),Object(P.jsxs)("div",{className:"token",children:["Token: ",Object(P.jsx)("input",{value:t,onChange:function(e){return r(v(e.target.value))}})]})]})]})}var re=function(e){return e.loading?Object(P.jsx)("span",{children:"Laden ..."}):null},ae=function(e){var t=e.error;return t?Object(P.jsxs)("section",{className:"app-error",children:[Object(P.jsx)("h2",{children:t.name}),Object(P.jsxs)("p",{children:["Error message : ",t.message]}),Object(P.jsxs)("p",{children:["Error code : ",t.code]})]}):null};n(59);function se(e){var t=function(e){var t=Object(c.useState)(!1),n=Object(w.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(void 0),i=Object(w.a)(s,2),o=i[0],l=i[1],u=Object(c.useState)(void 0),d=Object(w.a)(u,2),j=d[0],b=d[1],h=Object(c.useCallback)((function(){Object(y.a)(S.a.mark((function t(){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(!0),t.t0=l,t.next=5,L(e);case 5:t.t1=t.sent,(0,t.t0)(t.t1),b(void 0),t.next=15;break;case 10:t.prev=10,t.t2=t.catch(0),console.log(t.t2),l(void 0),b("Upps ein Fehler ist aufgetreten.");case 15:return t.prev=15,a(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,10,15,18]])})))()}),[e]);return Object(c.useEffect)(h,[h]),{data:o,error:j,loading:r,refetch:h}}(),n=t.data,r=t.error,a=t.loading,s=t.refetch,i=W(),o=i.userConsent,u=i.userSubscription,d=i.onClickAskUserPermission,j=i.onClickSusbribeToPushNotification,b=i.onClickSendSubscriptionToPushServer,h=i.onClickSendNotification,v=i.loading,O=i.error;return Object(c.useEffect)((function(){console.log("update push subscription"),"granted"===o&&null!=u&&b()}),[o,u,b]),Object(P.jsxs)("div",{className:"game",children:[Object(P.jsx)(q,{data:n}),Object(P.jsxs)("div",{className:"game-main",children:[a&&Object(P.jsx)(P.Fragment,{children:"Laden ..."}),r&&Object(P.jsx)(P.Fragment,{children:"string"===typeof r?r:JSON.stringify(r)}),n&&Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)(l.d,{children:[Object(P.jsx)(l.b,{path:"/levels",exact:!0,children:Object(P.jsx)(Z,{levels:n.levels})}),Object(P.jsx)(l.b,{path:"/quests",children:Object(P.jsx)(V,{quests:n.quests,refetch:s})}),Object(P.jsx)(l.b,{path:"/rewards",children:Object(P.jsx)(te,{refetch:s})}),Object(P.jsx)(l.b,{path:"/settings",children:Object(P.jsx)(ce,{userConsent:o,onClickAskUserPermission:d,onClickSusbribeToPushNotification:j,onClickSendNotification:h,loading:v,error:O})})]})})]}),Object(P.jsx)(l.b,{path:"/",component:Q})]})}n(60);function ie(){var e=X();return Object(c.useEffect)((function(){var t=function(){try{var e,t=null!==(e=new URLSearchParams(window.location.search).get("token"))&&void 0!==e?e:b.a.get("token");return null!==t&&void 0!==t?t:void 0}catch(n){return void console.warn("Error loading the permission token from url or cookie: ",JSON.stringify(n))}}();null!=t&&e(v(t))}),[e]),Object(P.jsx)("div",{className:"app",onTouchMove:function(e){return console.log(e)},children:Object(P.jsx)(se,{})})}var oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};i.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(a.a,{store:N,children:Object(P.jsxs)(o.a,{children:[Object(P.jsx)(l.b,{path:"/",exact:!0,component:function(){return Object(P.jsx)(l.a,{to:"/quests"})}}),Object(P.jsx)(ie,{})]})})}),document.getElementById("root")),oe()}},[[61,1,2]]]);
//# sourceMappingURL=main.fa1a5a8e.chunk.js.map